<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>记录各类第三方服务的ldap对接 | 小五的个人杂货铺</title><meta name="author" content="小五"><meta name="copyright" content="小五"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Rancher测试版本：2.7.x 参考文档：http:&#x2F;&#x2F;ranchermanager.docs.rancher.com&#x2F;zh&#x2F;pages-for-subheaders&#x2F;configure-openldap     Nexus3配置步骤登录nexus管理账户，进入配置界面  依次点击Security&gt;&gt;LDAP进入配置页面点击 “Create Connection” 创建LDAP连接"><meta property="og:type" content="article"><meta property="og:title" content="记录各类第三方服务的ldap对接"><meta property="og:url" content="https://xiaowu95.wang/posts/54998311/"><meta property="og:site_name" content="小五的个人杂货铺"><meta property="og:description" content="Rancher测试版本：2.7.x 参考文档：http:&#x2F;&#x2F;ranchermanager.docs.rancher.com&#x2F;zh&#x2F;pages-for-subheaders&#x2F;configure-openldap     Nexus3配置步骤登录nexus管理账户，进入配置界面  依次点击Security&gt;&gt;LDAP进入配置页面点击 “Create Connection” 创建LDAP连接"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://xiaowu95.wang/img/nba-logo29.jpg"><meta property="article:published_time" content="2023-05-03T16:00:00.000Z"><meta property="article:modified_time" content="2024-01-05T06:16:52.000Z"><meta property="article:author" content="小五"><meta property="article:tag" content="身份认证,角色授权"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://xiaowu95.wang/img/nba-logo29.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://xiaowu95.wang/posts/54998311/"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google-site-verification" content="kHfLZxYQ7y3s3AR7gyJDdJkQvGNjQsvopp6N3gEEx0s"><meta name="baidu-site-verification" content="codeva-aVS4F6wAjS"><link rel="manifest" href="/wang-xiaowu/pwa/site.webmanifest"><meta name="msapplication-TileColor" content="#fff"><link rel="apple-touch-icon" sizes="180x180" href="/wang-xiaowu/pwa/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/wang-xiaowu/pwa/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/wang-xiaowu/pwa/favicon-16x16.png"><link rel="mask-icon" href="/wang-xiaowu/pwa/safari-pinned-tab.svg" color="#5bbad5"><link rel="stylesheet" href="/css/index.css?v=5.2.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.36/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>(()=>{const t={set:(e,t,o)=>{if(!o)return;const a=Date.now()+864e5*o;localStorage.setItem(e,JSON.stringify({value:t,expiry:a}))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const{value:o,expiry:a}=JSON.parse(t);if(!(Date.now()>a))return o;localStorage.removeItem(e)}};window.btf={saveToLocal:t,getScript:(e,t={})=>new Promise(((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,Object.entries(t).forEach((([e,t])=>n.setAttribute(e,t))),n.onload=n.onreadystatechange=()=>{n.readyState&&!/loaded|complete/.test(n.readyState)||o()},n.onerror=a,document.head.appendChild(n)})),getCSS:(e,t)=>new Promise(((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onload=n.onreadystatechange=()=>{n.readyState&&!/loaded|complete/.test(n.readyState)||o()},n.onerror=a,document.head.appendChild(n)})),addGlobalFn:(e,t,o=!1,a=window)=>{const n=a.globalFn||{};n[e]=n[e]||{},n[e][o||Object.keys(n[e]).length]=t,a.globalFn=n}};const o=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},a=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};btf.activateDarkMode=o,btf.activateLightMode=a;const n=t.get("theme"),c=window.matchMedia("(prefers-color-scheme: dark)"),r=window.matchMedia("(prefers-color-scheme: light)");if(void 0===n){if(r.matches)a();else if(c.matches)o();else{const e=(new Date).getHours();e<=6||e>=18?o():a()}c.addEventListener("change",(()=>{void 0===t.get("theme")&&(e.matches?o():a())}))}else"light"===n?a():o();const d=t.get("aside-status");void 0!==d&&document.documentElement.classList.toggle("hide-aside","hide"===d);/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})()</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?86cb34987e15c900c39e12ebdf08c50d";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),btf.addGlobalFn("pjaxComplete",(()=>{_hmt.push(["_trackPageview",window.location.pathname])}),"baidu_analytics")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-1MFQ47191J"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-1MFQ47191J"),btf.addGlobalFn("pjaxComplete",(()=>{gtag("config","G-1MFQ47191J",{page_path:window.location.pathname})}),"google_analytics")</script><script>const GLOBAL_CONFIG={root:"/",algolia:{appId:"M91QAWRVY4",apiKey:"ecc30a5e06136e1cc491685e39801190",indexName:"xiaowu-blog",hitsPerPage:6,languages:{input_placeholder:"搜索文章",hits_empty:"未找到符合您查询的内容：${query}",hits_stats:"找到 ${hits} 条结果，耗时 ${time} 毫秒"}},localSearch:void 0,translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:400,highlightFullpage:!0,highlightMacStyle:!0},copy:{success:"复制成功",error:"复制失败",noSupport:"浏览器不支持"},relativeDate:{homepage:!0,post:!0},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:150,languages:{author:"作者: 小五",link:"链接: ",source:"来源: 小五的个人杂货铺",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"已切换为繁体中文",cht_to_chs:"已切换为简体中文",day_to_night:"已切换为深色模式",night_to_day:"已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"bottom-left"},infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!0,percent:{toc:!0,rightside:!0},autoDarkmode:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"记录各类第三方服务的ldap对接",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,isShuoshuo:!1}</script><script src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><link rel="stylesheet" href="/css/font.css"><style>.app-refresh{position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease}.app-refresh-wrap{display:flex;color:#fff;height:100%;align-items:center;justify-content:center}.app-refresh-wrap a{color:#fff;text-decoration:underline;cursor:pointer}</style><link rel="stylesheet" href="/css/titleStyle.css"><link rel="stylesheet" href="/css/mouse.css"><link rel="stylesheet" href="/css/custom.css"><style>.card-announcement .social-button{margin:.6rem 0 0 0;text-align:center}.card-announcement .social-button a{display:block;background-color:var(--btn-bg);color:var(--btn-color);text-align:center;line-height:2.4;margin:4px 0}.card-announcement .social-button a:hover{background-color:var(--btn-hover-color)}</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper/swiper/swiper.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper/swiper/swiperstyle.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css"><link rel="alternate" href="/atom.xml" title="小五的个人杂货铺" type="application/atom+xml"></head><body><script>window.paceOptions={restartOnPushState:!1},btf.addGlobalFn("pjaxSend",(()=>{Pace.restart()}),"pace_restart")</script><link rel="stylesheet" href="/css/pace.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/loading.gif" data-lazy-src="/img/avatar.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">550</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">163</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">58</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/github/"><i class="fa-fw fa-solid fa-address-card"></i> <span>关于我</span></a></div><div class="menus_item"><a class="site-page" href="/ac/"><i class="fa-fw fa-solid fa-wind"></i> <span>便携小空调</span></a></div><div class="menus_item"><a class="site-page" href="/talking/"><i class="fa-fw fa-solid fa-walkie-talkie"></i> <span>博客短记</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-compass"></i> <span>目录</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-otter"></i> <span>杂记</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/songs/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i> <span>图库</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fa-solid fa-film"></i> <span>影视|番剧</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book faa-fload"></i> <span>书单</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad faa-fload"></i> <span>游戏</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fa-brands fa-bilibili"></i> <span>BiliBili追番</span></a></li><li><a class="site-page child" href="/cinemas/"><i class="fa-fw fa-solid fa-video"></i> <span>BiliBili追剧</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-comment-dots"></i> <span>留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-user-group"></i> <span>友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-mug-saucer"></i> <span>Website Memo</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://console.leancloud.app/apps"><span>🚀 LeanCloud</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://vercel.com/dashboard"><span>🚀 Vercel</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://tongji.baidu.com/main/overview/10000432799/overview/index"><span>🚀 百度统计</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://ziyuan.baidu.com/dashboard/index"><span>🚀 百度站点管理</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://analytics.google.com/analytics/web/"><span>🚀 谷歌分析</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://search.google.com/search-console?hl=zh-cn"><span>🚀 谷歌站点管理</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.google.com/adsense/new/u/0/pub-1375421173355613/home"><span>🚀 谷歌广告联盟</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.algolia.com/"><span>🚀 Algolia</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://sms-activate.org/cn/"><span>🚀 Sms-activate</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://chatgpt.com/"><span>🚀 ChatGPT</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://poe.com/"><span>🚀 Poe聚合</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="http://www.idc.net/clientarea"><span>🚀 后浪云</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.west.cn/"><span>🚀 西部数据</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://shandianpro.com/#/dashboard"><span>🚀 闪电</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.huojian.homes/"><span>🚀 小火箭</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/winston779/gougou"><span>🚀 狗狗加速</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/img/nba-logo29.jpg)"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">小五的个人杂货铺</span></a><a class="nav-page-title" href="/"><span class="site-name">记录各类第三方服务的ldap对接</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/github/"><i class="fa-fw fa-solid fa-address-card"></i> <span>关于我</span></a></div><div class="menus_item"><a class="site-page" href="/ac/"><i class="fa-fw fa-solid fa-wind"></i> <span>便携小空调</span></a></div><div class="menus_item"><a class="site-page" href="/talking/"><i class="fa-fw fa-solid fa-walkie-talkie"></i> <span>博客短记</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-compass"></i> <span>目录</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-otter"></i> <span>杂记</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/songs/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i> <span>图库</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fa-solid fa-film"></i> <span>影视|番剧</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book faa-fload"></i> <span>书单</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad faa-fload"></i> <span>游戏</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fa-brands fa-bilibili"></i> <span>BiliBili追番</span></a></li><li><a class="site-page child" href="/cinemas/"><i class="fa-fw fa-solid fa-video"></i> <span>BiliBili追剧</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-comment-dots"></i> <span>留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-user-group"></i> <span>友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-mug-saucer"></i> <span>Website Memo</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://console.leancloud.app/apps"><span>🚀 LeanCloud</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://vercel.com/dashboard"><span>🚀 Vercel</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://tongji.baidu.com/main/overview/10000432799/overview/index"><span>🚀 百度统计</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://ziyuan.baidu.com/dashboard/index"><span>🚀 百度站点管理</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://analytics.google.com/analytics/web/"><span>🚀 谷歌分析</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://search.google.com/search-console?hl=zh-cn"><span>🚀 谷歌站点管理</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.google.com/adsense/new/u/0/pub-1375421173355613/home"><span>🚀 谷歌广告联盟</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.algolia.com/"><span>🚀 Algolia</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://sms-activate.org/cn/"><span>🚀 Sms-activate</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://chatgpt.com/"><span>🚀 ChatGPT</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://poe.com/"><span>🚀 Poe聚合</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="http://www.idc.net/clientarea"><span>🚀 后浪云</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.west.cn/"><span>🚀 西部数据</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://shandianpro.com/#/dashboard"><span>🚀 闪电</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.huojian.homes/"><span>🚀 小火箭</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/winston779/gougou"><span>🚀 狗狗加速</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">记录各类第三方服务的ldap对接<a class="post-edit-link" href="https://github.com/wang-xiaowu/wang-xiaowu.github.io/issues/new?_posts/身份认证,角色授权/记录各类第三方服务的ldap对接.md" rel="external nofollow noreferrer" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-05-03T16:00:00.000Z" title="发表于 2023-05-04 00:00:00">2023-05-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-05T06:16:52.000Z" title="更新于 2024-01-05 14:16:52">2024-01-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81-%E8%A7%92%E8%89%B2%E6%8E%88%E6%9D%83/">身份认证,角色授权</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">5.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>21分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:365,&quot;messagePrev&quot;:&quot;距离上一次更新该文章已经过了&quot;,&quot;messageNext&quot;:&quot;天，文章所描述的內容可能已经发生变化，请留意。&quot;,&quot;postUpdate&quot;:&quot;2024-01-05 14:16:52&quot;}" hidden></div><h1 id="Rancher"><a href="#Rancher" class="headerlink" title="Rancher"></a>Rancher</h1><p>测试版本：2.7.x</p><p>参考文档：<a target="_blank" rel="noopener external nofollow noreferrer" href="http://ranchermanager.docs.rancher.com/zh/pages-for-subheaders/configure-openldap">http://ranchermanager.docs.rancher.com/zh/pages-for-subheaders/configure-openldap</a></p><img src="/img/loading.gif" data-lazy-src="/posts/54998311/image-20230504155841586.png" title="image-20230504155841586"> <img src="/img/loading.gif" data-lazy-src="/posts/54998311/image-20230504155947575.png" title="image-20230504155947575"><h1 id="Nexus3"><a href="#Nexus3" class="headerlink" title="Nexus3"></a>Nexus3</h1><h2 id="配置步骤"><a href="#配置步骤" class="headerlink" title="配置步骤"></a>配置步骤</h2><h3 id="登录nexus管理账户，进入配置界面"><a href="#登录nexus管理账户，进入配置界面" class="headerlink" title="登录nexus管理账户，进入配置界面"></a>登录nexus管理账户，进入配置界面</h3><img src="/img/loading.gif" data-lazy-src="/posts/54998311/1059656-20190530161811890-1979900886.png" title="img"><h3 id="依次点击Security-LDAP进入配置页面"><a href="#依次点击Security-LDAP进入配置页面" class="headerlink" title="依次点击Security&gt;&gt;LDAP进入配置页面"></a>依次点击Security&gt;&gt;LDAP进入配置页面<img src="/img/loading.gif" data-lazy-src="/posts/54998311/1059656-20190530161905732-287771905.png" title="img"></h3><h3 id="点击-“Create-Connection”-创建LDAP连接"><a href="#点击-“Create-Connection”-创建LDAP连接" class="headerlink" title="点击 “Create Connection” 创建LDAP连接"></a>点击 “Create Connection” 创建LDAP连接</h3><img src="/img/loading.gif" data-lazy-src="/posts/54998311/1059656-20190530161659915-1778328709.png" title="img"><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">name：此连接的名称，可自定义</span><br><span class="line">LDAP server address</span><br><span class="line">    Protocol：是否启用SSL，是选用 LDAPS，否则选用 LDAP</span><br><span class="line">    Hostname：LDAP的服务器地址</span><br><span class="line">    Port：LDAP端口号</span><br><span class="line"><span class="keyword">Search</span> base：基本DN，即一般从域的根节点开始搜索，如 dc<span class="operator">=</span>test,dc<span class="operator">=</span>com</span><br><span class="line">Authentication <span class="keyword">method</span>：加密方式</span><br><span class="line">Username <span class="keyword">or</span> DN：输入用于获取LDAP用户的账户，建议使用只读账户</span><br><span class="line">    用户名：格式为 用户名@域名，如 userget<span class="variable">@test</span>.com</span><br><span class="line">    password：输入用户的密码</span><br><span class="line">    Connection rules：连接规则</span><br><span class="line">        第一个选框：超时时间，单位 秒</span><br><span class="line">        第二个选框：多少秒后重试</span><br><span class="line">        第三个选框：失败尝试次数</span><br></pre></td></tr></table></figure><h3 id="服务器信息填写完成后，点击-Verify-connection-测试连接"><a href="#服务器信息填写完成后，点击-Verify-connection-测试连接" class="headerlink" title="服务器信息填写完成后，点击 Verify connection 测试连接["></a>服务器信息填写完成后，点击 Verify connection 测试连接[</h3><img src="/img/loading.gif" data-lazy-src="/posts/54998311/1059656-20190530163112616-1726561584.png" title="img"><blockquote><p>右上角弹出测试结果，如测试连接失败，检查配置信息是否有误</p></blockquote><h3 id="测试成功后，点击-next-进入LDAP-用户和组配置"><a href="#测试成功后，点击-next-进入LDAP-用户和组配置" class="headerlink" title="测试成功后，点击 next 进入LDAP 用户和组配置"></a>测试成功后，点击 next 进入LDAP 用户和组配置</h3><ul><li>情景一：所有用户都在 Users 根节点下<ul><li>视情况选择 Configuration template 为 Active Directory或者generic ldap server，所有配置默认即可<img src="/img/loading.gif" data-lazy-src="/posts/54998311/1059656-20190530165308532-766775045.png" title="img"></li></ul></li><li>情景二：大部分用户在Users目录中，但还有其他目录存在用户<ul><li>视情况选择 Configuration template 为 Active Directory或者generic ldap server</li><li>勾选 User subtree 下的复选框</li><li>其他配置信息默认<img src="/img/loading.gif" data-lazy-src="/posts/54998311/1059656-20190530165322924-2058791447.png" title="img"></li></ul></li><li>情景三：其他情况<ul><li>视情况选择 Configuration template 为 Active Directory或者generic ldap server</li><li>去掉 Base DN默认值</li><li>勾选 User subtree 下的复选框</li><li>输入User fitter，值为：(&amp;(objectCategory&#x3D;Person)(sAMAccountName&#x3D;*))<img src="/img/loading.gif" data-lazy-src="/posts/54998311/1059656-20190530165836231-1286723983.png" title="img"></li></ul></li></ul><h3 id="点击-Verify-user-mapping-测试获取用户列表"><a href="#点击-Verify-user-mapping-测试获取用户列表" class="headerlink" title="点击 Verify user mapping 测试获取用户列表"></a>点击 Verify user mapping 测试获取用户列表</h3><img src="/img/loading.gif" data-lazy-src="/posts/54998311/1059656-20190530171958391-1839759272.png" title="img"><h3 id="点击-Verify-login-测试ldap-用户登录"><a href="#点击-Verify-login-测试ldap-用户登录" class="headerlink" title="点击 Verify login 测试ldap 用户登录"></a>点击 Verify login 测试ldap 用户登录</h3><img src="/img/loading.gif" data-lazy-src="/posts/54998311/1059656-20190530172012228-145143746.png" title="img"> <img src="/img/loading.gif" data-lazy-src="/posts/54998311/1059656-20190530172021223-506022784.png" title="img"><h3 id="点击-Save-保存，退出当前用户，使用LDAP用户登录，配置完成。"><a href="#点击-Save-保存，退出当前用户，使用LDAP用户登录，配置完成。" class="headerlink" title="点击 Save 保存，退出当前用户，使用LDAP用户登录，配置完成。"></a>点击 Save 保存，退出当前用户，使用LDAP用户登录，配置完成。</h3><h1 id="Rancher2-6-7-Monitoring-Grafana"><a href="#Rancher2-6-7-Monitoring-Grafana" class="headerlink" title="Rancher2.6&#x2F;7 Monitoring Grafana"></a><a target="_blank" rel="noopener external nofollow noreferrer" href="https://my.oschina.net/rancher/blog/5553988">Rancher2.6&#x2F;7 Monitoring Grafana</a></h1><h2 id="先决条件"><a href="#先决条件" class="headerlink" title="先决条件"></a><strong>先决条件</strong></h2><ul><li>Rancher：2.6.x&#x2F;2.7.x</li><li>k8s：1.24.x</li><li>monitoring：100.1.2+up19.0.3</li><li>OpenLDAP：latest</li></ul><h2 id="Grafana-对接-LDAP"><a href="#Grafana-对接-LDAP" class="headerlink" title="Grafana 对接 LDAP"></a><strong>Grafana 对接 LDAP</strong></h2><h3 id="编辑-Monitoring-Yaml-配置-LDAP"><a href="#编辑-Monitoring-Yaml-配置-LDAP" class="headerlink" title="编辑 Monitoring Yaml 配置 LDAP"></a><strong>编辑 Monitoring Yaml 配置 LDAP</strong></h3><h4 id="Edit-YAML"><a href="#Edit-YAML" class="headerlink" title="Edit YAML"></a>Edit YAML</h4><p>访问 Rancher explorer UI，进入 Apps &amp; Marketplace，选择 Monitoring，在配置选项中选择 Edit YAML：</p><img src="/img/loading.gif" data-lazy-src="/posts/54998311/14154602_Rnn1.png" title="img"><h4 id="开启-LDAP-认证配置"><a href="#开启-LDAP-认证配置" class="headerlink" title="开启 LDAP 认证配置"></a>开启 LDAP 认证配置</h4><p>在 <code>grafana.grafana.ini</code> 层级下新增如下 <code>auth.ldap</code> 配置信息开启 LDAP：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">grafana:</span></span><br><span class="line">  <span class="attr">grafana.ini:</span></span><br><span class="line">    <span class="attr">auth.ldap:</span></span><br><span class="line">      <span class="attr">allow_sign_up:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">config_file:</span> <span class="string">/etc/grafana/ldap.toml</span></span><br><span class="line">      <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><img src="/img/loading.gif" data-lazy-src="/posts/54998311/14154602_glKW.png" title="img"><h4 id="在-grafana-层级下，添加-LDAP-认证参数"><a href="#在-grafana-层级下，添加-LDAP-认证参数" class="headerlink" title="在 grafana 层级下，添加 LDAP 认证参数"></a>在 <code>grafana</code> 层级下，添加 LDAP 认证参数</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">grafana:</span></span><br><span class="line">  <span class="attr">ldap:</span></span><br><span class="line">    <span class="attr">config:</span> <span class="string">|</span></span><br><span class="line"><span class="string">      [[servers]]</span></span><br><span class="line"><span class="string">      host = &quot;test.zerchin.xyz&quot; </span></span><br><span class="line"><span class="string">      port = 389</span></span><br><span class="line"><span class="string">      use_ssl = false</span></span><br><span class="line"><span class="string">      start_tls = false</span></span><br><span class="line"><span class="string">      ssl_skip_verify = true</span></span><br><span class="line"><span class="string">      bind_dn = &quot;cn=admin,dc=rancherldap,dc=com&quot;</span></span><br><span class="line"><span class="string">      bind_password = &#x27;Rancher123&#x27;</span></span><br><span class="line"><span class="string">      search_filter = &quot;(cn=%s)&quot;</span></span><br><span class="line"><span class="string">      search_base_dns = [&quot;cn=group,ou=rancher,dc=rancherldap,dc=com&quot;]</span></span><br><span class="line"><span class="string">      [servers.attributes]</span></span><br><span class="line"><span class="string">      name = &quot;givenName&quot;</span></span><br><span class="line"><span class="string">      surname = &quot;sn&quot;</span></span><br><span class="line"><span class="string">      username = &quot;cn&quot;</span></span><br><span class="line"><span class="string">      member_of = &quot;memberOf&quot;</span></span><br><span class="line"><span class="string">      email = &quot;email&quot;</span></span><br><span class="line"><span class="string"></span>    <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h5 id="参数说明："><a href="#参数说明：" class="headerlink" title="参数说明："></a><strong>参数说明</strong>：</h5><p><code>host</code>：LDAP 服务器地址（IP&#x2F;Domain，指定多个地址空格分隔）。</p><p><code>port</code>：LDAP 端口，默认是 389，如果 use_ssl&#x3D;true 则是 636。</p><p><code>use_ssl</code>：是否使用加密 TLS 连接。</p><p><code>start_tls</code>：STARTTLS 是一种明文通信协议的扩展，能够让明文的通信连线直接成为加密连线（使用 SSL&#x2F;TLS 加密），而不需要使用另一个特别的端口来进行加密通信。</p><p><code>ssl_skip_verify</code>：是否跳过 SSL 证书验证。</p><p><code>bind_dn</code>：LDAP 服务账户用户名。</p><p><code>bind_password</code>：密码（如果密码包含 #，则需要用三个括号引起来，例如：“”“#password;”“”）。</p><p><code>search_filter</code>：用户查询过滤字段，例如 <code>&quot;(cn=%s)&quot;</code> 、<code>&quot;(sAMAccountName=%s)&quot;</code> 、 <code>&quot;(uid=%s)&quot;</code>。</p><p><code>search_base_dns</code>：用户搜索起点。</p><h4 id="配置好之后启动监控"><a href="#配置好之后启动监控" class="headerlink" title="配置好之后启动监控"></a>配置好之后启动监控</h4><p>等待监控启动成功后，打开 Grafana UI 界面，默认账号密码为：admin&#x2F;prom-operator</p><img src="/img/loading.gif" data-lazy-src="/posts/54998311/14154602_TMdu.png" title="img"><h3 id="LDAP-验证"><a href="#LDAP-验证" class="headerlink" title="LDAP 验证"></a><strong>LDAP 验证</strong></h3><p>登录之后，左侧进入 Server Admin - LDAP，在 LDAP Connection 下可以看到连接的主机。</p><p>在 Test user mapping 下，搜索存在的 LDAP 用户，可以查到用户信息。</p><img src="/img/loading.gif" data-lazy-src="/posts/54998311/14154602_3UxX.png" title="img"><h1 id="Elastic-Stack"><a href="#Elastic-Stack" class="headerlink" title="Elastic Stack"></a>Elastic Stack</h1><h2 id="先决条件-1"><a href="#先决条件-1" class="headerlink" title="先决条件"></a>先决条件</h2><blockquote><p>保证elasticserach是白金版以上，破解教程参考站内<code>elasticsearch 7.x白金破解</code></p></blockquote><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>ES LDAP官方：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-put-role-mapping.html">https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-put-role-mapping.html</a></p><p>ES LDAP 集成：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.jianshu.com/p/5b10475c605a">https://www.jianshu.com/p/5b10475c605a</a></p><p>ELK部署至K8s并启用AD认证：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://lzzeng.github.io/log-analysis/k8s-elk-auth-kibana-via-ad/">https://lzzeng.github.io/log-analysis/k8s-elk-auth-kibana-via-ad/</a></p><p>Elasticsearch LDAP 用户鉴权：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://juejin.cn/post/7132739314902892574">https://juejin.cn/post/7132739314902892574</a></p><h2 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h2><h3 id="elasticsearch-yml"><a href="#elasticsearch-yml" class="headerlink" title="elasticsearch.yml"></a>elasticsearch.yml</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cluster.name</span>=<span class="string">elasticsearch-cluster</span></span><br><span class="line"><span class="attr">node.name</span>=<span class="string">es-node1</span></span><br><span class="line"><span class="attr">network.host</span>=<span class="string">0.0.0.0</span></span><br><span class="line"><span class="attr">network.publish_host</span>=<span class="string">node1.elastic.com</span></span><br><span class="line"><span class="attr">http.port</span>=<span class="string">9200</span></span><br><span class="line"><span class="attr">transport.tcp.port</span>=<span class="string">9300</span></span><br><span class="line"><span class="attr">http.cors.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">http.cors.allow-origin</span>=<span class="string">*</span></span><br><span class="line"><span class="attr">discovery.type</span>=<span class="string">single-node</span></span><br><span class="line"><span class="attr">node.master</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">node.data</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">discovery.seed_hosts[0]</span>=<span class="string">node1.elastic.com</span></span><br><span class="line"><span class="attr">discovery.zen.minimum_master_nodes</span>=<span class="string">1</span></span><br><span class="line"><span class="attr">http.cors.allow-headers</span>=<span class="string">Authorization</span></span><br><span class="line"><span class="attr">bootstrap.memory_lock</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"># es开启xpack的前提是，必须配置ssl，所以此处必须有</span></span><br><span class="line"><span class="attr">xpack.security.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">xpack.security.http.ssl.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">xpack.security.transport.ssl.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">xpack.security.http.ssl.key</span>=<span class="string">/usr/share/elasticsearch/config/certs/es-node1.key</span></span><br><span class="line"><span class="attr">xpack.security.http.ssl.certificate</span>=<span class="string">/usr/share/elasticsearch/config/certs/es-node1.crt</span></span><br><span class="line"><span class="attr">xpack.security.http.ssl.certificate_authorities</span>=<span class="string">/usr/share/elasticsearch/config/certs/ca.crt</span></span><br><span class="line"><span class="attr">xpack.security.transport.ssl.key</span>=<span class="string">/usr/share/elasticsearch/config/certs/es-node1.key</span></span><br><span class="line"><span class="attr">xpack.security.transport.ssl.certificate</span>=<span class="string">/usr/share/elasticsearch/config/certs/es-node1.crt</span></span><br><span class="line"><span class="attr">xpack.security.transport.ssl.certificate_authorities</span>=<span class="string">/usr/share/elasticsearch/config/certs/ca.crt</span></span><br><span class="line"><span class="comment"># 此处是配置ldap认证的核心信息</span></span><br><span class="line"><span class="attr">xpack.security.authc.realms.ldap.ldap1.order</span>=<span class="string">0</span></span><br><span class="line"><span class="attr">xpack.security.authc.realms.ldap.ldap1.url</span>=<span class="string">ldap://&lt;ldapIp&gt;:&lt;ldapPort&gt;</span></span><br><span class="line"><span class="attr">xpack.security.authc.realms.ldap.ldap1.bind_dn</span>=<span class="string">cn=admin,dc=extension,dc=sopei</span></span><br><span class="line"><span class="attr">xpack.security.authc.realms.ldap.ldap1.bind_password</span>=<span class="string">xxxxxx</span></span><br><span class="line"><span class="attr">xpack.security.authc.realms.ldap.ldap1.user_search.base_dn</span>=<span class="string">ou=people,dc=extension,dc=sopei</span></span><br><span class="line"><span class="attr">xpack.security.authc.realms.ldap.ldap1.user_search.filter</span>=<span class="string">(cn=&#123;0&#125;)</span></span><br><span class="line"><span class="attr">xpack.security.authc.realms.ldap.ldap1.unmapped_groups_as_roles</span>=<span class="string">false</span></span><br><span class="line"><span class="comment"># role_mapping.yml，可配置可不配，就放这里参考下，一般通过api配置映射关系。因为通过文件的形式需要每个node都存放一份。</span></span><br><span class="line"><span class="comment"># xpack.security.authc.realms.ldap.ldap1.files.role_mapping=/usr/share/elasticsearch/config/role_mapping.yml</span></span><br></pre></td></tr></table></figure><h3 id="role-mapping-yml"><a href="#role-mapping-yml" class="headerlink" title="role_mapping.yml"></a>role_mapping.yml</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如下所示，superuser 是在我们的 Elasticsearch 中已经定义好的 role。赋予如下账户superuser角色</span></span><br><span class="line"><span class="attr">superuser:</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">&quot;cn=liuxg,ou=users,dc=example,dc=com&quot;</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">&quot;cn=xgliu,ou=users,dc=example,dc=com&quot;</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">&quot;employeeNumber=1,ou=users,dc=example,dc=com&quot;</span></span><br></pre></td></tr></table></figure><h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST /_security/role_mapping/&lt;name&gt;</span><br><span class="line">PUT /_security/role_mapping/&lt;name&gt;</span><br></pre></td></tr></table></figure><h3 id="先决条件-2"><a href="#先决条件-2" class="headerlink" title="先决条件"></a>先决条件</h3><ul><li>要使用此 API，你至少具有<code>manage_security</code>集群权限。</li></ul><h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>角色映射定义分配给每个用户的角色。每个映射都有 识别用户的规则和授予这些用户的<em>角色</em>列表。</p><p>角色映射 API 通常是管理角色映射的首选方式，而不是使用<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-roles.html#mapping-roles-file">角色映射文件</a>。创建或更新角色映射 API 无法更新角色映射文件中定义的角色映射。</p><p>此 API 不创建角色。相反，它将用户映射到现有角色。可以使用<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-put-role.html">创建或更新角色 API</a>或<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/defining-roles.html#roles-management-file">角色文件</a>来创建角色。</p><p>有关详细信息，参阅<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-roles.html">将用户和组映射到角色</a>。</p><h4 id="角色模板"><a href="#角色模板" class="headerlink" title="角色模板"></a>角色模板</h4><p>角色映射最常见的用途是创建从用户的已知值到固定角色名称的映射。例如， <code>cn=admin,dc=example,dc=com</code>应该为 LDAP 组中的所有用户赋予<code>superuser</code>Elasticsearch 中的角色。该<code>roles</code>字段用于此目的。</p><p>对于更复杂的需求，可以使用 Mustache 模板动态确定应授予用户的角色名称。该 <code>role_templates</code>字段用于此目的。</p><p>要成功使用角色模板，必须启用相关的脚本功能。否则，使用角色模板创建角色映射的所有尝试都会失败。参阅<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting-security.html#allowed-script-types-setting">允许的脚本类型设置</a>。</p><p>角色映射中可用的所有<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/role-mapping-resources.html">用户字段</a><code>rules</code>在角色模板中也可用。因此，可以将用户分配给反映他们的<code>username</code>、他们的或他们验证的<code>groups</code>名称的角色。<code>realm</code></p><p>默认情况下，评估模板以生成单个字符串，该字符串是应分配给用户的角色的名称。如果<code>format</code>模板的 设置为<code>&quot;json&quot;</code>那么模板应该为角色名称生成一个 JSON 字符串或一个 JSON 字符串数组。</p><h3 id="路径参数"><a href="#路径参数" class="headerlink" title="路径参数"></a>路径参数</h3><ul><li><p><strong><code>name</code></strong></p><p>（字符串）标识角色映射的独特名称。该名称仅用作标识符，以促进通过 API 进行交互；它不会以任何方式影响映射的行为。</p></li></ul><h3 id="主体参数"><a href="#主体参数" class="headerlink" title="主体参数"></a>主体参数</h3><p>以下参数可以在 PUT 或 POST 求的主体中指定，并且与添加角色映射有关：</p><ul><li><p><strong><code>enabled</code></strong></p><p>(Required, Boolean)执行角色映射时忽略 已<code>enabled</code>设置为的映射。<code>false</code></p></li><li><p><strong><code>metadata</code></strong></p><p>（对象）帮助定义分配给每个用户的角色的附加metadata字段。在该<code>metadata</code>对象中，以 开头的键<code>_</code>保留供系统使用。</p></li><li><p><strong><code>roles</code></strong></p><p>（字符串列表）授予与角色映射规则匹配的用户的角色名称列表。必须指定<code>roles</code>或<code>role_templates</code>中的一个。</p></li><li><p><strong><code>role_templates</code></strong></p><p>（对象列表）胡子模板列表，将对其进行评估以确定应授予与角色映射规则匹配的用户的角色名称。这些对象的格式定义如下。必须指定<code>roles</code>或<code>role_templates</code>中的一个。</p></li><li><p><strong><code>rules</code></strong></p><p>（必需，对象）确定映射应匹配哪些用户的规则。规则是使用 JSON DSL 表达的逻辑条件。参阅 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/role-mapping-resources.html">角色映射资源</a>。</p></li></ul><h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>以下示例将“user”角色分配给所有用户：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">POST</span> <span class="string">/_security/role_mapping/mapping1</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;roles&quot;:</span> [ <span class="string">&quot;user&quot;</span>],</span><br><span class="line">  <span class="attr">&quot;enabled&quot;:</span> <span class="literal">true</span>, </span><br><span class="line">  <span class="attr">&quot;rules&quot;:</span> &#123;</span><br><span class="line">    <span class="string">&quot;field&quot;</span> <span class="string">:</span> &#123; <span class="string">&quot;username&quot;</span> <span class="string">:</span> <span class="string">&quot;*&quot;</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;metadata&quot;</span> <span class="string">:</span> &#123; </span><br><span class="line">    <span class="string">&quot;version&quot;</span> <span class="string">:</span> <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>执行角色映射时，已<code>enabled</code>设置为的映射将被忽略。<code>false</code></p><p>metadata字段是可选的。</p></blockquote><p>成功的调用会返回一个 JSON 结构，显示映射是已创建还是已更新。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;role_mapping&quot;</span> <span class="string">:</span> &#123;</span><br><span class="line">    <span class="string">&quot;created&quot;</span> <span class="string">:</span> <span class="literal">true</span> </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>更新现有映射时，<code>created</code>设置为 false。</p></blockquote><p>以下示例将“user”和“管理admin”角色分配给特定用户：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">POST</span> <span class="string">/_security/role_mapping/mapping2</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;roles&quot;:</span> [ <span class="string">&quot;user&quot;</span>, <span class="string">&quot;admin&quot;</span> ],</span><br><span class="line">  <span class="attr">&quot;enabled&quot;:</span> <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;rules&quot;:</span> &#123;</span><br><span class="line">     <span class="string">&quot;field&quot;</span> <span class="string">:</span> &#123; <span class="string">&quot;username&quot;</span> <span class="string">:</span> [ <span class="string">&quot;esadmin01&quot;</span>, <span class="string">&quot;esadmin02&quot;</span> ] &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以下示例匹配针对特定领域进行身份验证的用户：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">POST</span> <span class="string">/_security/role_mapping/mapping3</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;roles&quot;:</span> [ <span class="string">&quot;ldap-user&quot;</span> ],</span><br><span class="line">  <span class="attr">&quot;enabled&quot;:</span> <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;rules&quot;:</span> &#123;</span><br><span class="line">    <span class="string">&quot;field&quot;</span> <span class="string">:</span> &#123; <span class="string">&quot;realm.name&quot;</span> <span class="string">:</span> <span class="string">&quot;ldap1&quot;</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以下示例匹配用户名是<code>esadmin</code> 或用户在<code>cn=admin,dc=example,dc=com</code>组中的任何用户：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">POST</span> <span class="string">/_security/role_mapping/mapping4</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;roles&quot;:</span> [ <span class="string">&quot;superuser&quot;</span> ],</span><br><span class="line">  <span class="attr">&quot;enabled&quot;:</span> <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;rules&quot;:</span> &#123;</span><br><span class="line">    <span class="attr">&quot;any&quot;:</span> [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;field&quot;:</span> &#123;</span><br><span class="line">          <span class="attr">&quot;username&quot;:</span> <span class="string">&quot;esadmin&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;field&quot;:</span> &#123;</span><br><span class="line">          <span class="attr">&quot;groups&quot;:</span> <span class="string">&quot;cn=admins,dc=example,dc=com&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当你的身份管理系统（例如 Active Directory 或 SAML 身份提供商）中的组名称与 Elasticsearch 中的角色名称没有一对一的对应关系时，上面的示例很有用。角色映射是将组名与角色名链接起来的方法。</p><p>但是，在极少数情况下，你的组名称可能与你的 Elasticsearch 角色名称完全匹配。当你的 SAML 身份提供者包含自己的“组映射”功能并且可以配置为在用户的 SAML 属性中发布 Elasticsearch 角色名称时，就会出现这种情况。</p><p>在这些情况下，可以使用将组名称视为角色名称的模板。</p><p><strong>注意</strong>：仅当你打算为所有提供的组定义角色时才应执行此操作。将用户映射到大量不必要或未定义的角色是低效的，并且会对系统性能产生负面影响。如果你只需要映射组的一个子集，那么你应该使用显式映射来执行此操作。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">POST</span> <span class="string">/_security/role_mapping/mapping5</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;role_templates&quot;:</span> [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;template&quot;:</span> &#123; <span class="attr">&quot;source&quot;:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123;#tojson&#125;&#125;</span>groups<span class="template-variable">&#123;&#123;/tojson&#125;&#125;</span>&quot;</span> &#125;, </span><br><span class="line">      <span class="string">&quot;format&quot;</span> <span class="string">:</span> <span class="string">&quot;json&quot;</span> </span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;rules&quot;:</span> &#123;</span><br><span class="line">    <span class="string">&quot;field&quot;</span> <span class="string">:</span> &#123; <span class="string">&quot;realm.name&quot;</span> <span class="string">:</span> <span class="string">&quot;saml1&quot;</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;enabled&quot;:</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>mustache函数<code>tojson</code>用于将组名列表转换为有效的 JSON 数组。</p><p>因为模板生成一个 JSON 数组，所以格式必须设置为<code>json</code>.</p></blockquote><p>以下示例匹配特定 LDAP 子树中的用户：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">POST</span> <span class="string">/_security/role_mapping/mapping6</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;roles&quot;:</span> [ <span class="string">&quot;example-user&quot;</span> ],</span><br><span class="line">  <span class="attr">&quot;enabled&quot;:</span> <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;rules&quot;:</span> &#123;</span><br><span class="line">    <span class="string">&quot;field&quot;</span> <span class="string">:</span> &#123; <span class="string">&quot;dn&quot;</span> <span class="string">:</span> <span class="string">&quot;*,ou=subtree,dc=example,dc=com&quot;</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以下示例匹配特定领域中特定 LDAP 子树中的用户：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">POST</span> <span class="string">/_security/role_mapping/mapping7</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;roles&quot;:</span> [ <span class="string">&quot;ldap-example-user&quot;</span> ],</span><br><span class="line">  <span class="attr">&quot;enabled&quot;:</span> <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;rules&quot;:</span> &#123;</span><br><span class="line">    <span class="attr">&quot;all&quot;:</span> [</span><br><span class="line">      &#123; <span class="string">&quot;field&quot;</span> <span class="string">:</span> &#123; <span class="string">&quot;dn&quot;</span> <span class="string">:</span> <span class="string">&quot;*,ou=subtree,dc=example,dc=com&quot;</span> &#125; &#125;,</span><br><span class="line">      &#123; <span class="string">&quot;field&quot;</span> <span class="string">:</span> &#123; <span class="string">&quot;realm.name&quot;</span> <span class="string">:</span> <span class="string">&quot;ldap1&quot;</span> &#125; &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>规则可能更复杂，包括通配符匹配。例如，以下映射匹配满足<strong>所有</strong>这些条件的任何用户：</p><ul><li>可分辨名称与模式匹配<code>*,ou=admin,dc=example,dc=com</code>，或者用户名是<code>es-admin</code>，或者用户名是<code>es-system</code></li><li><code>cn=people,dc=example,dc=com</code>群组 中的用户</li><li>用户没有<code>terminated_date</code></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">POST</span> <span class="string">/_security/role_mapping/mapping8</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;roles&quot;:</span> [ <span class="string">&quot;superuser&quot;</span> ],</span><br><span class="line">  <span class="attr">&quot;enabled&quot;:</span> <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;rules&quot;:</span> &#123;</span><br><span class="line">    <span class="attr">&quot;all&quot;:</span> [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;any&quot;:</span> [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">&quot;field&quot;:</span> &#123;</span><br><span class="line">              <span class="attr">&quot;dn&quot;:</span> <span class="string">&quot;*,ou=admin,dc=example,dc=com&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">&quot;field&quot;:</span> &#123;</span><br><span class="line">              <span class="attr">&quot;username&quot;:</span> [ <span class="string">&quot;es-admin&quot;</span>, <span class="string">&quot;es-system&quot;</span> ]</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;field&quot;:</span> &#123;</span><br><span class="line">          <span class="attr">&quot;groups&quot;:</span> <span class="string">&quot;cn=people,dc=example,dc=com&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;except&quot;:</span> &#123;</span><br><span class="line">          <span class="attr">&quot;field&quot;:</span> &#123;</span><br><span class="line">            <span class="attr">&quot;metadata.terminated_date&quot;:</span> <span class="literal">null</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>模板化角色可用于自动将每个用户映射到他们自己的自定义角色。角色本身可以通过 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-put-role.html">Roles API</a>或使用 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/custom-roles-authorization.html#implementing-custom-roles-provider">自定义角色提供程序</a>来定义。</p><p>在此示例中，每个使用“cloud-saml”领域进行身份验证的用户都将自动映射到两个角色 - 角色<code>&quot;saml_user&quot;</code>和一个角色，其用户名前缀为<code>_user_</code>. 例如，用户<code>nwong</code>将被分配<code>saml_user</code>和 <code>_user_nwong</code>角色。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">POST</span> <span class="string">/_security/role_mapping/mapping9</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;rules&quot;:</span> &#123; <span class="attr">&quot;field&quot;:</span> &#123; <span class="attr">&quot;realm.name&quot;:</span> <span class="string">&quot;cloud-saml&quot;</span> &#125; &#125;,</span><br><span class="line">  <span class="attr">&quot;role_templates&quot;:</span> [</span><br><span class="line">    &#123; <span class="attr">&quot;template&quot;:</span> &#123; <span class="string">&quot;source&quot;</span> <span class="string">:</span> <span class="string">&quot;saml_user&quot;</span> &#125; &#125;, </span><br><span class="line">    &#123; <span class="attr">&quot;template&quot;:</span> &#123; <span class="string">&quot;source&quot;</span> <span class="string">:</span> <span class="string">&quot;_user_<span class="template-variable">&#123;&#123;username&#125;&#125;</span>&quot;</span> &#125; &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;enabled&quot;:</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>因为不可能在同一个角色映射中同时指定<code>roles</code>和<code>role_templates</code>，所以我们可以通过使用没有替换的模板来应用“固定名称”角色。</p></blockquote><h2 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h2><blockquote><p>这里我们仅创建两种mapping，一种admin，一种basic_user</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GET /_security/role_mapping/admins</span></span><br><span class="line"><span class="comment"># DELETE /_security/role_mapping/admins</span></span><br><span class="line"><span class="comment"># GET /_security/role_mapping/basic_users</span></span><br><span class="line"><span class="comment"># DELETE /_security/role_mapping/basic_users</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对管理员的绑定</span></span><br><span class="line"><span class="string">PUT</span> <span class="string">/_security/role_mapping/admins</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;roles&quot;</span> <span class="string">:</span> [ <span class="string">&quot;superuser&quot;</span> ],</span><br><span class="line">  <span class="string">&quot;rules&quot;</span> <span class="string">:</span> &#123; <span class="string">&quot;field&quot;</span> <span class="string">:</span> &#123;</span><br><span class="line">    <span class="string">&quot;dn&quot;</span> <span class="string">:</span> <span class="string">&quot;uid=xiaowu,ou=people,dc=extension,dc=sopei&quot;</span></span><br><span class="line">  &#125; &#125;,</span><br><span class="line">  <span class="attr">&quot;enabled&quot;:</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对普通用户的绑定,例子中仅对开发组成员赋权</span></span><br><span class="line"><span class="string">PUT</span> <span class="string">/_security/role_mapping/basic_users</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;enabled&quot;</span> <span class="string">:</span> <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&quot;roles&quot;</span> <span class="string">:</span> [ </span><br><span class="line">      <span class="string">&quot;log-all-viewer&quot;</span>,</span><br><span class="line">      <span class="string">&quot;devlopment&quot;</span>,</span><br><span class="line">      <span class="string">&quot;reporting_user&quot;</span> </span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;rules&quot;</span> <span class="string">:</span> &#123;</span><br><span class="line">      <span class="string">&quot;any&quot;</span> <span class="string">:</span> [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;field&quot;</span> <span class="string">:</span> &#123;</span><br><span class="line">            <span class="string">&quot;groups&quot;</span> <span class="string">:</span> <span class="string">&quot;cn=od-3d5d12d234493102cbc1ceef154d9c38,ou=feishuroot,dc=extension,dc=sopei&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;metadata&quot;</span> <span class="string">:</span> &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><h3 id="ldap用户删除后仍可登录"><a href="#ldap用户删除后仍可登录" class="headerlink" title="ldap用户删除后仍可登录"></a>ldap用户删除后仍可登录</h3><blockquote><p>Elasticsearch 与 LDAP 集成时，用户的身份验证是通过 LDAP 服务器进行的。如果你已经在 Elasticsearch 中配置了 LDAP 集成，并且已经删除了 LDAP 中的用户，则该用户将无法再登录 LDAP 服务器，但仍然可以登录 Elasticsearch。这是因为 Elasticsearch 缓存了先前身份验证的用户凭据，以便在将来的请求中使用，而不是每次都要向 LDAP 服务器发出身份验证请求。</p></blockquote><h3 id="配置会话缓存时间"><a href="#配置会话缓存时间" class="headerlink" title="配置会话缓存时间"></a>配置会话缓存时间</h3><p>参考：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.elastic.co/guide/en/elasticsearch/reference/master/security-settings.html#ref-ldap-settings">https://www.elastic.co/guide/en/elasticsearch/reference/master/security-settings.html#ref-ldap-settings</a></p><blockquote><p>在默认情况下，Elasticsearch 的 LDAP 集成会缓存 LDAP 用户凭据，以便在将来的请求中使用。缓存的时间取决于 Elasticsearch 配置中 <code>cache.ttl</code> 参数的设置，默认值为 <code>20m</code>，这意味着，如果你删除了 LDAP 中的用户，该用户在 Elasticsearch 中的访问仅受到缓存的时间限制，通常会在 20m 内失效。</p></blockquote><h1 id="Jumpserver"><a href="#Jumpserver" class="headerlink" title="Jumpserver"></a>Jumpserver</h1><p>参考：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.jumpserver.org/zh/v2/admin-guide/authentication/ldap/">https://docs.jumpserver.org/zh/v2/admin-guide/authentication/ldap/</a></p><img src="/img/loading.gif" data-lazy-src="/posts/54998311/image-20230504163448448.png" title="image-20230504163448448"><h1 id="Yearning"><a href="#Yearning" class="headerlink" title="Yearning"></a>Yearning</h1><p>项目地址：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/cookieY/Yearning">https://github.com/cookieY/Yearning</a></p><p>参考：<a target="_blank" rel="noopener external nofollow noreferrer" href="http://next.yearning.io/guide/config/ldap.html">http://next.yearning.io/guide/config/ldap.html</a></p><img src="/img/loading.gif" data-lazy-src="/posts/54998311/image-20230504165218435.png" title="image-20230504165218435"><h1 id="Sonarqube"><a href="#Sonarqube" class="headerlink" title="Sonarqube"></a>Sonarqube</h1><p>参考地址：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.sonarqube.org/latest/instance-administration/authentication/ldap/">https://docs.sonarqube.org/latest/instance-administration/authentication/ldap/</a></p><p>修改<code>&lt;SONARQUBE_HOME&gt;/conf/sonar.properties</code></p><p>示例配置如下：</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LDAP configuration</span></span><br><span class="line"><span class="comment"># General Configuration</span></span><br><span class="line"><span class="attr">sonar.security.realm</span>=<span class="string">LDAP</span></span><br><span class="line"><span class="attr">ldap.url</span>=<span class="string">ldap://myserver.mycompany.com</span></span><br><span class="line"><span class="attr">ldap.bindDn</span>=<span class="string">admin_bind_dn</span></span><br><span class="line"><span class="attr">ldap.bindPassword</span>=<span class="string">admin_bind_password</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment"># User Configuration</span></span><br><span class="line"><span class="attr">ldap.user.baseDn</span>=<span class="string">ou=Users,dc=mycompany,dc=com</span></span><br><span class="line"><span class="attr">ldap.user.request</span>=<span class="string">(&amp;(objectClass=inetOrgPerson)(uid=&#123;login&#125;))</span></span><br><span class="line"><span class="attr">ldap.user.realNameAttribute</span>=<span class="string">cn</span></span><br><span class="line"><span class="attr">ldap.user.emailAttribute</span>=<span class="string">mail</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"># Group Configuration</span></span><br><span class="line"><span class="attr">ldap.group.baseDn</span>=<span class="string">ou=Groups,dc=sonarsource,dc=com</span></span><br><span class="line"><span class="attr">ldap.group.request</span>=	<span class="string">(&amp;(objectClass=groupOfUniqueNames)(uniqueMember=&#123;dn&#125;))</span></span><br></pre></td></tr></table></figure><h1 id="Yapi"><a href="#Yapi" class="headerlink" title="Yapi"></a>Yapi</h1><p>项目地址： <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/fjc0k/docker-YApi">https://github.com/fjc0k/docker-YApi</a></p><blockquote><p>注：yapi默认以用户名和邮箱为唯一标准，所以最好将yapi库中存储账户邮箱改成和ldap一一对应的，这样依赖就可以直接继承下原yapi库下的账户</p><p>这里贴下将原有邮箱后缀改成指定邮箱后缀的mongo sql</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># 将email字段中以sopei.yapi结尾的数据全部改成以<span class="variable">@eryajf</span>.net结尾</span><br><span class="line">db.user.updateMany(</span><br><span class="line">    &#123; email: &#123; $regex: <span class="operator">/</span><span class="variable">@sopei</span>.yapi$<span class="operator">/</span> &#125; &#125;,</span><br><span class="line">    [</span><br><span class="line">      &#123;</span><br><span class="line">        $<span class="keyword">set</span>: &#123;</span><br><span class="line">          email: &#123;</span><br><span class="line">            $concat: [</span><br><span class="line">              &#123; $arrayElemAt: [&#123; $split: [<span class="string">&#x27;$email&#x27;</span>, <span class="string">&#x27;@&#x27;</span>] &#125;, <span class="number">0</span>] &#125;,</span><br><span class="line">              <span class="string">&#x27;@eryajf.net&#x27;</span></span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">    )</span><br></pre></td></tr></table></figure></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">yapi-web:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">jayfong/yapi:1.10.2</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">yapi-web</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">40001</span><span class="string">:3000</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_ADMIN_ACCOUNT=admin@xxx.yapi</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_ADMIN_PASSWORD=xxx</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_NPM_REGISTRY=https://registry.npm.taobao.org</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_CLOSE_REGISTER=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_DB_SERVERNAME=&lt;mongoIp&gt;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_DB_PORT=&lt;mongoPort&gt;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_DB_DATABASE=&lt;mongoDatabase&gt;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_DB_USER=&lt;mongoUser&gt;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_DB_PASS=&lt;mongoPass&gt;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_DB_AUTH_SOURCE=&lt;MongoDB</span> <span class="string">身份认证所用库&gt;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_MAIL_ENABLE=false</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_LDAP_LOGIN_ENABLE=true</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_LDAP_LOGIN_SERVER=ldap://&lt;ldapIp&gt;:&lt;ldapPort&gt;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_LDAP_LOGIN_BASE_DN=&lt;ldap管理员dn&gt;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_LDAP_LOGIN_BIND_PASSWORD=&lt;ldap管理员密码&gt;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_LDAP_LOGIN_SEARCH_DN=&lt;ldap用户搜索范围&gt;</span></span><br><span class="line">      <span class="comment"># 下面这个是user filter，按此格式进行进行修改</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_LDAP_LOGIN_SEARCH_STANDARD=&amp;(objectClass=inetOrgPerson)(cn=%s)</span></span><br><span class="line">      <span class="comment"># 邮箱后缀，经测试似乎没啥用</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_LDAP_LOGIN_EMAIL_POSTFIX=&#x27;@eryajf.net&#x27;</span></span><br><span class="line">      <span class="comment"># ldap映射字段</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_LDAP_LOGIN_EMAIL_KEY=mail</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_LDAP_LOGIN_USERNAME_KEY=cn</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">YAPI_PLUGINS=[]</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br></pre></td></tr></table></figure><h1 id="Gitlab"><a href="#Gitlab" class="headerlink" title="Gitlab"></a>Gitlab</h1><p>参考：<a target="_blank" rel="noopener external nofollow noreferrer" href="https://forum.gitlab.cn/t/topic/620">https://forum.gitlab.cn/t/topic/620</a></p><blockquote><p>注：Gitlab默认以用户名和邮箱为唯一标准，所以最好将Gitlab中存储账户邮箱改成和ldap一一对应的，这样依赖就可以直接继承下原Gitlab下的账户</p></blockquote><h2 id="极狐GitLab集成LDAP背景介绍"><a href="#极狐GitLab集成LDAP背景介绍" class="headerlink" title="极狐GitLab集成LDAP背景介绍"></a>极狐GitLab集成LDAP背景介绍</h2><h3 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h3><ul><li>将现有的LDAP用户同步到GitLab中<ul><li>支持快速将LDAP服务器管理的用户同步到GitLab中</li><li>支持通过规则限定特定分类的LDAP用户同步到GitLab中</li></ul></li><li>使用LDAP服务管理极狐GitLab用户<ul><li>支持使用LDAP服务创建和管理GitLab用户</li></ul></li></ul><h3 id="LDAP安全性检查"><a href="#LDAP安全性检查" class="headerlink" title="LDAP安全性检查"></a>LDAP安全性检查</h3><ul><li>集成LDAP前需要对你的系统做以下检查，以确保使用的安全性<ul><li>你的LDAP用户无法修改服务器中的<code>mail</code>,<code>email</code>,<code>userPrincipalName</code>字段</li><li>你的LDAP用户不能分享同一个email地址，否则这些用户可以访问同一个GitLab用户的资源</li></ul></li></ul><h3 id="其他说明"><a href="#其他说明" class="headerlink" title="其他说明"></a>其他说明</h3><ul><li>社区用户可以使用LDAP集成的基础功能，部分高级功能仅开放给订阅用户</li></ul><h2 id="配置LDAP集成"><a href="#配置LDAP集成" class="headerlink" title="配置LDAP集成"></a>配置LDAP集成</h2><h3 id="参考极狐官网安装GitLab"><a href="#参考极狐官网安装GitLab" class="headerlink" title="参考极狐官网安装GitLab"></a>参考极狐官网安装GitLab</h3><ul><li>参考<a target="_blank" rel="noopener external nofollow noreferrer" href="https://gitlab.cn/install/">安装极狐</a>部署GitLab</li></ul><h3 id="修改配置并重新配置GitLab实例"><a href="#修改配置并重新配置GitLab实例" class="headerlink" title="修改配置并重新配置GitLab实例"></a>修改配置并重新配置GitLab实例</h3><ul><li>修改主配置文件<code>/etc/gitlab/gitlab.rb</code>添加以下内容：</li><li>注：每个版本的配置各不同，所以按需修改</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">gitlab_rails[&#x27;ldap_enabled&#x27;]</span> <span class="string">=</span> <span class="literal">true</span></span><br><span class="line"><span class="string">gitlab_rails[&#x27;prevent_ldap_sign_in&#x27;]</span> <span class="string">=</span> <span class="literal">false</span></span><br><span class="line"><span class="string">gitlab_rails[&#x27;ldap_servers&#x27;]</span> <span class="string">=</span> <span class="string">YAML.load</span> <span class="string">&lt;&lt;-&#x27;EOS&#x27;</span> <span class="comment"># remember to close this block with &#x27;EOS&#x27; below</span></span><br><span class="line"><span class="string">&#x27;main&#x27;</span> <span class="string">=&gt;</span> &#123;</span><br><span class="line">  <span class="string">&#x27;label&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;LDAP&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;host&#x27;</span> <span class="string">=&gt;</span>  <span class="string">&#x27;ldap.mydomain.com&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;port&#x27;</span> <span class="string">=&gt;</span> <span class="number">389</span>,</span><br><span class="line">  <span class="string">&#x27;uid&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;&lt;sAMAccountName&gt;或&lt;uid&gt;&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;encryption&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;simple_tls&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;verify_certificates&#x27;</span> <span class="string">=&gt;</span> <span class="literal">false</span>,</span><br><span class="line">  <span class="string">&#x27;bind_dn&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;管理员dn&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;password&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;管理员pass&#x27;</span>,</span><br><span class="line">  <span class="comment"># 可选</span></span><br><span class="line">  <span class="string">&#x27;tls_options&#x27;</span> <span class="string">=&gt;</span> &#123;</span><br><span class="line">    <span class="string">&#x27;ca_file&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;ssl_version&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;ciphers&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;cert&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;key&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&#x27;timeout&#x27;</span> <span class="string">=&gt;</span> <span class="number">10</span>,</span><br><span class="line">  <span class="comment"># 此处配置ldap源服务器是否是ad，如果此处设置true，那么allow_username_or_email_login最好设置为false</span></span><br><span class="line">  <span class="string">&#x27;active_directory&#x27;</span> <span class="string">=&gt;</span> <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&#x27;allow_username_or_email_login&#x27;</span> <span class="string">=&gt;</span> <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&#x27;block_auto_created_users&#x27;</span> <span class="string">=&gt;</span> <span class="literal">false</span>,</span><br><span class="line">  <span class="comment"># 此处设置user find dn</span></span><br><span class="line">  <span class="string">&#x27;base&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;ou=people,dc=extension,dc=net&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;user_filter&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="comment"># 字段映射</span></span><br><span class="line">  <span class="string">&#x27;attributes&#x27;</span> <span class="string">=&gt;</span> &#123;</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span> <span class="string">=&gt;</span> [<span class="string">&#x27;uid&#x27;</span>, <span class="string">&#x27;userid&#x27;</span>, <span class="string">&#x27;sAMAccountName&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;email&#x27;</span> <span class="string">=&gt;</span> [<span class="string">&#x27;mail&#x27;</span>, <span class="string">&#x27;email&#x27;</span>, <span class="string">&#x27;userPrincipalName&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;cn&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;first_name&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;givenName&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;last_name&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;sn&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&#x27;lowercase_usernames&#x27;</span> <span class="string">=&gt;</span> <span class="literal">false</span>,</span><br><span class="line"><span class="string">EOS</span></span><br></pre></td></tr></table></figure><ul><li>并修改以下字段</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;label&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;LDAP&#x27;</span> <span class="comment"># 该字段为LDAP服务名称，该名称会展示在GitLab Portal的登陆界面</span></span><br><span class="line"><span class="string">&#x27;host&#x27;</span> <span class="string">=&gt;</span>  <span class="string">&#x27;ldap.mydomain.com&#x27;</span> <span class="comment"># 该字段为LDAP服务器的地址</span></span><br><span class="line"><span class="string">&#x27;bind_dn&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;_the_full_dn_of_the_user_you_will_bind_with&#x27;</span> <span class="comment"># 该字段为LDAP管理员用户的DN</span></span><br><span class="line"><span class="string">&#x27;password&#x27;</span> <span class="string">=&gt;</span> <span class="string">&#x27;_the_password_of_the_bind_user&#x27;</span> <span class="comment"># 该字段为LDAP管理员用户的password</span></span><br></pre></td></tr></table></figure><ul><li>其他配置项目参考<a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.gitlab.com/ee/administration/auth/ldap/#basic-configuration-settings">LDAP基础配置 4</a></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例如，你可以通过配置user_filter将部分ldap用户同步到GitLab中</span></span><br><span class="line"><span class="string">&#x27;(employeeType=developer)&#x27;</span></span><br><span class="line"><span class="string">&#x27;(&amp;(objectclass=user)(|(samaccountname=momo)(samaccountname=toto)))&#x27;</span></span><br></pre></td></tr></table></figure><ul><li>执行<code>sudo gitlab-ctl reconfigure</code>使得上述配置生效</li></ul><h3 id="使用Rake-Task检查同步情况"><a href="#使用Rake-Task检查同步情况" class="headerlink" title="使用Rake Task检查同步情况"></a>使用Rake Task检查同步情况</h3><ul><li>配置完成后，可使用LDAP相关的Rake Task检查用户同步情况<code>gitlab-rake gitlab:ldap:check[100]</code>该命令检查前100个LDAP用户</li></ul><h2 id="其他LDAP配置"><a href="#其他LDAP配置" class="headerlink" title="其他LDAP配置"></a>其他LDAP配置</h2><h3 id="LDAP用户同步周期"><a href="#LDAP用户同步周期" class="headerlink" title="LDAP用户同步周期"></a>LDAP用户同步周期</h3><ul><li>GitLab默认每日执行LDAP用户同步，如果你需要修改LDAP的同步周期，可以通过修改<code>/etc/gitlab/gitlab.rb</code>中配置实现</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">gitlab_rails[&#x27;ldap_sync_worker_cron&#x27;]</span> <span class="string">=</span> <span class="string">&quot;0 */12 * * *&quot;</span></span><br></pre></td></tr></table></figure><h2 id="如未生效可执行gitlab-ctl-restart重启下"><a href="#如未生效可执行gitlab-ctl-restart重启下" class="headerlink" title="如未生效可执行gitlab-ctl restart重启下"></a><a target="_blank" rel="noopener external nofollow noreferrer" href="https://forum.gitlab.cn/t/topic/1731">如未生效可执行<code>gitlab-ctl restart</code>重启下</a></h2></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者:</span> <span class="post-copyright-info"><a href="https://xiaowu95.wang">小五</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接:</span> <span class="post-copyright-info"><a href="https://xiaowu95.wang/posts/54998311/">https://xiaowu95.wang/posts/54998311/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://xiaowu95.wang" target="_blank">小五的个人杂货铺</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81-%E8%A7%92%E8%89%B2%E6%8E%88%E6%9D%83/">身份认证,角色授权</a></div><div class="post-share"><div class="social-share" data-image="/img/nba-logo29.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>感谢支持</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wxpay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/loading.gif" data-lazy-src="/img/wxpay.jpg" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/loading.gif" data-lazy-src="/img/alipay.jpg" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/ca95835b/" title="python生成requirements.txt的方法"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/nba-logo14.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">python生成requirements.txt的方法</div></div><div class="info-2"><div class="info-item-1">python项目如何在另一个环境上重新构建项目所需要的运行环境依赖包？ 使用的时候边记边加载是个很麻烦的事情，总会出现遗漏的包的问题，这个时候手动安装也很麻烦，不能确定代码报错的需要安装的包是什么版本。这些问题，requirements.txt都可以解决！ 生成requirements.txt，有两种方式： 第一种 适用于单虚拟环境的情况1pip3 freeze &gt; requirements.txt 为什么只适用于单虚拟环境？因为这种方式，会将环境中的依赖包全都加入，如果使用的全局环境，则下载的所有包在里面，不管是不是当前项目依赖的 当然这种情况并不是我们想要的，当我们使用的是全局环境时，可以使用第二种方法。 第二种 (推荐) 使用pipreqs github地址为：pipreq 12345# 安装# pip3 install pipreqs -i https://pypi.tuna.tsinghua.edu.cn/simple/pip3 install pipreqs# 在当前目录生成pipreqs . --encoding=utf8...</div></div></div></a><a class="pagination-related" href="/posts/9ad9224f/" title="elasticsearch7.x白金版破解"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/nba-logo24.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">elasticsearch7.x白金版破解</div></div><div class="info-2"><div class="info-item-1">背景 因为要将es接入ldap认证，而该功能是收费版本，所以我这里选择破解白金版 原理license中有个signature字段，ES会根据这个字段判断License是否被篡改。只要取消ES的这个判断逻辑，就可以随便篡改License，达到激活的目的了。 下面的示例将会以官方 ES Docker 镜像 7.14.0...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/2e1f9495/" title="LDAP学习总结"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/nba-logo9.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2023-04-22</div><div class="info-item-2">LDAP学习总结</div></div><div class="info-2"><div class="info-item-1">摘自：https://lework.github.io/2019/07/18/ldap/ 安装使用参考： http://ldapdoc.eryajf.net/pages/f081dc/ https://github.com/behappy-project/behappy-docker-application/tree/master/ldap LDAP概念LDAP是轻量目录访问协议,英文全称是Lightweight Directory Access Protocol,一般都简称为LDAP.它是基于X.500标准的,但是简单多了并且可以根据需要定制.与X.500不同,LDAP支持TCP/IP,这对访问Internet是必须的.LDAP的核心规范在RFC中都有定义,所有与LDAP相关的RFC都可以在LDAPman RFC网页中找到.简单说来,LDAP是一个得到关于人或者资源的集中、静态数据的快速方式....</div></div></div></a><a class="pagination-related" href="/posts/9bbf0b6e/" title="keycloak https required"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/nba-logo14.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2023-06-16</div><div class="info-item-2">keycloak https required</div></div><div class="info-2"><div class="info-item-1">keycloak登录提示 At this point, you have two options; 1) Install HTTPS in Wildfly or 2) Tunnel via SSH into the remote machine and proxy your browser through it, go to the admin console and turn off the SSL requirement (Realm Settings -&gt; Login -&gt; Require SSL). This works because SSL is not required for local connections. keycloak 用私有地址可以不使用ssl登录方式，如果用公网就需要用ssl登录方式。 解决方案：设置某realm不强制使用ssl 启动: 1./standalone.sh -b 0.0.0.0 -bmanagement 0.0.0.0 添加账号 1./add-user-keycloak -r master -u...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/loading.gif" data-lazy-src="/img/avatar.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info-name">小五</div><div class="author-info-description">Tomorrow will be better,Everything will be fine</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">550</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">163</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">58</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/wang-xiaowu"><i class="fab fa-github"></i><span>GitHub</span></a><div class="card-info-social-icons"><a class="social-icon" href="/random" target="_blank" title="随便逛逛"><i class="fa-solid fa-shuffle"></i></a><a class="social-icon" href="mailto:wangxiaowu950330@foxmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://space.bilibili.com/30655189?spm_id_from=333.1007.0.0" rel="external nofollow noreferrer" target="_blank" title="BiliBili"><i class="fa-brands fa-bilibili"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fa-solid fa-rss"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Rancher"><span class="toc-number">1.</span> <span class="toc-text">Rancher</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Nexus3"><span class="toc-number">2.</span> <span class="toc-text">Nexus3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.1.</span> <span class="toc-text">配置步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BB%E5%BD%95nexus%E7%AE%A1%E7%90%86%E8%B4%A6%E6%88%B7%EF%BC%8C%E8%BF%9B%E5%85%A5%E9%85%8D%E7%BD%AE%E7%95%8C%E9%9D%A2"><span class="toc-number">2.1.1.</span> <span class="toc-text">登录nexus管理账户，进入配置界面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%9D%E6%AC%A1%E7%82%B9%E5%87%BBSecurity-LDAP%E8%BF%9B%E5%85%A5%E9%85%8D%E7%BD%AE%E9%A1%B5%E9%9D%A2"><span class="toc-number">2.1.2.</span> <span class="toc-text">依次点击Security&gt;&gt;LDAP进入配置页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%82%B9%E5%87%BB-%E2%80%9CCreate-Connection%E2%80%9D-%E5%88%9B%E5%BB%BALDAP%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.1.3.</span> <span class="toc-text">点击 “Create Connection” 创建LDAP连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BF%A1%E6%81%AF%E5%A1%AB%E5%86%99%E5%AE%8C%E6%88%90%E5%90%8E%EF%BC%8C%E7%82%B9%E5%87%BB-Verify-connection-%E6%B5%8B%E8%AF%95%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.1.4.</span> <span class="toc-text">服务器信息填写完成后，点击 Verify connection 测试连接[</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E6%88%90%E5%8A%9F%E5%90%8E%EF%BC%8C%E7%82%B9%E5%87%BB-next-%E8%BF%9B%E5%85%A5LDAP-%E7%94%A8%E6%88%B7%E5%92%8C%E7%BB%84%E9%85%8D%E7%BD%AE"><span class="toc-number">2.1.5.</span> <span class="toc-text">测试成功后，点击 next 进入LDAP 用户和组配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%82%B9%E5%87%BB-Verify-user-mapping-%E6%B5%8B%E8%AF%95%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E5%88%97%E8%A1%A8"><span class="toc-number">2.1.6.</span> <span class="toc-text">点击 Verify user mapping 测试获取用户列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%82%B9%E5%87%BB-Verify-login-%E6%B5%8B%E8%AF%95ldap-%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95"><span class="toc-number">2.1.7.</span> <span class="toc-text">点击 Verify login 测试ldap 用户登录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%82%B9%E5%87%BB-Save-%E4%BF%9D%E5%AD%98%EF%BC%8C%E9%80%80%E5%87%BA%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%EF%BC%8C%E4%BD%BF%E7%94%A8LDAP%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%EF%BC%8C%E9%85%8D%E7%BD%AE%E5%AE%8C%E6%88%90%E3%80%82"><span class="toc-number">2.1.8.</span> <span class="toc-text">点击 Save 保存，退出当前用户，使用LDAP用户登录，配置完成。</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Rancher2-6-7-Monitoring-Grafana"><span class="toc-number">3.</span> <span class="toc-text">Rancher2.6&#x2F;7 Monitoring Grafana</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%88%E5%86%B3%E6%9D%A1%E4%BB%B6"><span class="toc-number">3.1.</span> <span class="toc-text">先决条件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Grafana-%E5%AF%B9%E6%8E%A5-LDAP"><span class="toc-number">3.2.</span> <span class="toc-text">Grafana 对接 LDAP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91-Monitoring-Yaml-%E9%85%8D%E7%BD%AE-LDAP"><span class="toc-number">3.2.1.</span> <span class="toc-text">编辑 Monitoring Yaml 配置 LDAP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Edit-YAML"><span class="toc-number">3.2.1.1.</span> <span class="toc-text">Edit YAML</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E5%90%AF-LDAP-%E8%AE%A4%E8%AF%81%E9%85%8D%E7%BD%AE"><span class="toc-number">3.2.1.2.</span> <span class="toc-text">开启 LDAP 认证配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8-grafana-%E5%B1%82%E7%BA%A7%E4%B8%8B%EF%BC%8C%E6%B7%BB%E5%8A%A0-LDAP-%E8%AE%A4%E8%AF%81%E5%8F%82%E6%95%B0"><span class="toc-number">3.2.1.3.</span> <span class="toc-text">在 grafana 层级下，添加 LDAP 认证参数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E%EF%BC%9A"><span class="toc-number">3.2.1.3.1.</span> <span class="toc-text">参数说明：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%A5%BD%E4%B9%8B%E5%90%8E%E5%90%AF%E5%8A%A8%E7%9B%91%E6%8E%A7"><span class="toc-number">3.2.1.4.</span> <span class="toc-text">配置好之后启动监控</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LDAP-%E9%AA%8C%E8%AF%81"><span class="toc-number">3.2.2.</span> <span class="toc-text">LDAP 验证</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Elastic-Stack"><span class="toc-number">4.</span> <span class="toc-text">Elastic Stack</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%88%E5%86%B3%E6%9D%A1%E4%BB%B6-1"><span class="toc-number">4.1.</span> <span class="toc-text">先决条件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">4.2.</span> <span class="toc-text">参考</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">4.3.</span> <span class="toc-text">修改配置文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#elasticsearch-yml"><span class="toc-number">4.3.1.</span> <span class="toc-text">elasticsearch.yml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#role-mapping-yml"><span class="toc-number">4.3.2.</span> <span class="toc-text">role_mapping.yml</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#API"><span class="toc-number">4.4.</span> <span class="toc-text">API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%88%E5%86%B3%E6%9D%A1%E4%BB%B6-2"><span class="toc-number">4.4.1.</span> <span class="toc-text">先决条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%8F%E8%BF%B0"><span class="toc-number">4.4.2.</span> <span class="toc-text">描述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%92%E8%89%B2%E6%A8%A1%E6%9D%BF"><span class="toc-number">4.4.2.1.</span> <span class="toc-text">角色模板</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84%E5%8F%82%E6%95%B0"><span class="toc-number">4.4.3.</span> <span class="toc-text">路径参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E4%BD%93%E5%8F%82%E6%95%B0"><span class="toc-number">4.4.4.</span> <span class="toc-text">主体参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-number">4.4.5.</span> <span class="toc-text">例子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E6%88%98"><span class="toc-number">4.5.</span> <span class="toc-text">实战</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-number">4.6.</span> <span class="toc-text">问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ldap%E7%94%A8%E6%88%B7%E5%88%A0%E9%99%A4%E5%90%8E%E4%BB%8D%E5%8F%AF%E7%99%BB%E5%BD%95"><span class="toc-number">4.6.1.</span> <span class="toc-text">ldap用户删除后仍可登录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E4%BC%9A%E8%AF%9D%E7%BC%93%E5%AD%98%E6%97%B6%E9%97%B4"><span class="toc-number">4.6.2.</span> <span class="toc-text">配置会话缓存时间</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Jumpserver"><span class="toc-number">5.</span> <span class="toc-text">Jumpserver</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Yearning"><span class="toc-number">6.</span> <span class="toc-text">Yearning</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Sonarqube"><span class="toc-number">7.</span> <span class="toc-text">Sonarqube</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Yapi"><span class="toc-number">8.</span> <span class="toc-text">Yapi</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Gitlab"><span class="toc-number">9.</span> <span class="toc-text">Gitlab</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%81%E7%8B%90GitLab%E9%9B%86%E6%88%90LDAP%E8%83%8C%E6%99%AF%E4%BB%8B%E7%BB%8D"><span class="toc-number">9.1.</span> <span class="toc-text">极狐GitLab集成LDAP背景介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">9.1.1.</span> <span class="toc-text">使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LDAP%E5%AE%89%E5%85%A8%E6%80%A7%E6%A3%80%E6%9F%A5"><span class="toc-number">9.1.2.</span> <span class="toc-text">LDAP安全性检查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E8%AF%B4%E6%98%8E"><span class="toc-number">9.1.3.</span> <span class="toc-text">其他说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AELDAP%E9%9B%86%E6%88%90"><span class="toc-number">9.2.</span> <span class="toc-text">配置LDAP集成</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%9E%81%E7%8B%90%E5%AE%98%E7%BD%91%E5%AE%89%E8%A3%85GitLab"><span class="toc-number">9.2.1.</span> <span class="toc-text">参考极狐官网安装GitLab</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E5%B9%B6%E9%87%8D%E6%96%B0%E9%85%8D%E7%BD%AEGitLab%E5%AE%9E%E4%BE%8B"><span class="toc-number">9.2.2.</span> <span class="toc-text">修改配置并重新配置GitLab实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Rake-Task%E6%A3%80%E6%9F%A5%E5%90%8C%E6%AD%A5%E6%83%85%E5%86%B5"><span class="toc-number">9.2.3.</span> <span class="toc-text">使用Rake Task检查同步情况</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96LDAP%E9%85%8D%E7%BD%AE"><span class="toc-number">9.3.</span> <span class="toc-text">其他LDAP配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LDAP%E7%94%A8%E6%88%B7%E5%90%8C%E6%AD%A5%E5%91%A8%E6%9C%9F"><span class="toc-number">9.3.1.</span> <span class="toc-text">LDAP用户同步周期</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E6%9C%AA%E7%94%9F%E6%95%88%E5%8F%AF%E6%89%A7%E8%A1%8Cgitlab-ctl-restart%E9%87%8D%E5%90%AF%E4%B8%8B"><span class="toc-number">9.4.</span> <span class="toc-text">如未生效可执行gitlab-ctl restart重启下</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/c75c82a0/" title="使用 TypeScript 创建 Koa 服务器"><img src="/img/loading.gif" data-lazy-src="/img/nba-logo16.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="使用 TypeScript 创建 Koa 服务器"></a><div class="content"><a class="title" href="/posts/c75c82a0/" title="使用 TypeScript 创建 Koa 服务器">使用 TypeScript 创建 Koa 服务器</a><time datetime="2025-10-11T06:00:11.000Z" title="发表于 2025-10-11 14:00:11">2025-10-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/c9d8bfa7/" title="Nodejs应用提取heap并加以分析的一些常用方法"><img src="/img/loading.gif" data-lazy-src="/img/nba-logo24.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Nodejs应用提取heap并加以分析的一些常用方法"></a><div class="content"><a class="title" href="/posts/c9d8bfa7/" title="Nodejs应用提取heap并加以分析的一些常用方法">Nodejs应用提取heap并加以分析的一些常用方法</a><time datetime="2025-09-28T07:54:43.000Z" title="发表于 2025-09-28 15:54:43">2025-09-28</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url(/img/nba-logo29.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By 小五</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a href="https://www.foreverblog.cn/" rel="external nofollow noreferrer" target="_blank"><img src="/img/loading.gif" data-lazy-src="https://img.foreverblog.cn/logo_en_default.png" alt="十年之约" style="width:auto;height:16px"></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/npm/hexo-theme-butterfly@5.2.2/source/js/utils.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-butterfly@5.2.2/source/js/main.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-butterfly@5.2.2/source/js/tw_cn.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.36/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.1.3/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"><script>(()=>{const e=()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");if(0===e.length)return;const t=()=>(e=>{window.loadMermaid=!0;const t="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";e.forEach(((e,n)=>{const d=e.firstElementChild,a=`mermaid-${n}`,r=`%%{init:{ 'theme':'${t}'}}%%\n`+d.textContent,i=mermaid.render(a,r),m=e=>{d.insertAdjacentHTML("afterend",e)};"string"==typeof i?m(i):i.then((({svg:e})=>m(e)))}))})(e);btf.addGlobalFn("themeChange",t,"mermaid"),window.loadMermaid?t():btf.getScript("https://cdn.jsdelivr.net/npm/mermaid@11.4.0/dist/mermaid.min.js").then(t)};btf.addGlobalFn("encrypt",e,"mermaid"),window.pjax?e():document.addEventListener("DOMContentLoaded",e)})()</script><script>(()=>{const t=document.querySelectorAll("#article-container .chartjs-container");if(0===t.length)return;const e=(t,a)=>{"object"==typeof t&&null!==t&&Object.keys(t).forEach((r=>{const n=t[r];"object"==typeof n&&null!==n&&(n[a]?t[r]=n[a]:e(n,a))}))},a=()=>{window.loadChartJS=!0,Array.from(t).forEach(((t,a)=>{const r=t.firstElementChild,n=t.getAttribute("data-chartjs-id")||"chartjs-"+a,d=t.getAttribute("data-width"),o=document.getElementById(n);o&&o.parentNode.remove();const c=r.textContent,l=document.createElement("canvas");l.id=n;const s=document.createElement("div");s.className="chartjs-wrap",d&&(s.style.width=d),s.appendChild(l),r.insertAdjacentElement("afterend",s);const h=document.getElementById(n).getContext("2d"),i=JSON.parse(c),m="dark"===document.documentElement.getAttribute("data-theme")?"dark-mode":"light-mode";(t=>{"dark-mode"===t?(Chart.defaults.color="rgba(255, 255, 255, 0.8)",Chart.defaults.borderColor="rgba(255, 255, 255, 0.2)",Chart.defaults.scale.ticks.backdropColor="transparent"):(Chart.defaults.color="rgba(0, 0, 0, 0.8)",Chart.defaults.borderColor="rgba(0, 0, 0, 0.1)",Chart.defaults.scale.ticks.backdropColor="transparent")})(m),e(i,m),new Chart(h,i)}))},r=()=>{window.loadChartJS?a():btf.getScript("https://cdn.jsdelivr.net/npm/chart.js@4.4.6/dist/chart.umd.min.js").then(a)};btf.addGlobalFn("themeChange",a,"chartjs"),btf.addGlobalFn("encrypt",a,"chartjs"),window.pjax?r():document.addEventListener("DOMContentLoaded",r)})()</script></div><div class="aplayer no-destroy" data-id="9061017364" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listfolded="false" data-order="random" data-lrctype="1" data-preload="none" data-autoplay="false" muted></div><div class="app-refresh" id="app-refresh"><div class="app-refresh-wrap"><label>网站已更新最新版本</label> <a href="javascript:void(0)" rel="external nofollow noreferrer" onclick="location.reload()">点击刷新</a></div></div><script>function showNotification(){if(GLOBAL_CONFIG.Snackbar){var t="light"===document.documentElement.getAttribute("data-theme")?GLOBAL_CONFIG.Snackbar.bgLight:GLOBAL_CONFIG.Snackbar.bgDark,e=GLOBAL_CONFIG.Snackbar.position;Snackbar.show({text:"已更新最新版本",backgroundColor:t,duration:5e5,pos:e,actionText:"点击刷新",actionTextColor:"#fff",onActionClick:function(t){location.reload()}})}else{var o=`top: 0; background: ${"light"===document.documentElement.getAttribute("data-theme")?"#49b1f5":"#1f1f1f"};`;document.getElementById("app-refresh").style.cssText=o}}"serviceWorker"in navigator&&(navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("controllerchange",(function(){showNotification()})),window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js")})))</script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script defer src="/js/diytitle.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,POWERMODE.mobile=!0,document.body.addEventListener("input",POWERMODE)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/metingjs/dist/Meting.min.js"></script><script>btf.addGlobalFn("pjaxSend",(()=>{if(window.aplayers)for(let a=0;a<window.aplayers.length;a++)window.aplayers[a].options.fixed||window.aplayers[a].destroy()}),"destroyAplayer"),btf.addGlobalFn("pjaxComplete",loadMeting,"runMetingJS")</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>(()=>{window.pjax=new Pjax({elements:'a:not([target="_blank"]):not([href="/talking/"]):not([href="/artitalk/"])',selectors:['link[rel="canonical"]','meta[property="og:image"]','meta[property="og:title"]','meta[property="og:url"]',"head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"],cacheBust:!1,analytics:!0,scrollRestoration:!1});const e=e=>{e&&Object.values(e).forEach((e=>e()))};document.addEventListener("pjax:send",(()=>{btf.removeGlobalFnEvent("pjaxSendOnce"),btf.removeGlobalFnEvent("themeChange");const t=document.body.classList;t.contains("read-mode")&&t.remove("read-mode"),e(window.globalFn.pjaxSend)})),document.addEventListener("pjax:complete",(()=>{btf.removeGlobalFnEvent("pjaxCompleteOnce"),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),a=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(a)),e.parentNode.replaceChild(t,e)})),e(window.globalFn.pjaxComplete)})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404")}))})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch@5.12.0/dist/lite/builds/browser.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.75.3/dist/instantsearch.production.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-butterfly@5.2.2/source/js/search/algolia.min.js"></script></div></div><script data-pjax>if(document.getElementById("recent-posts")&&"/"==location.pathname){var parent=document.getElementById("recent-posts"),child='<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo25.jpg" alt="/img/nba-logo25.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2024-02-02</span><a class="blog-slider__title" href="posts/1bcb0ad4/">单环境,多分支并行开发方案(流量染色/istio)</a><div class="blog-slider__text">单环境,多分支并行开发方案(流量染色/istio)</div><a class="blog-slider__button" href="posts/1bcb0ad4/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo15.jpg" alt="/img/nba-logo15.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2023-04-06</span><a class="blog-slider__title" href="posts/2a9d73ff/">教你如何零成本从0到1，开发上线一个对接了openAI的机器人</a><div class="blog-slider__text">教你如何零成本从0到1，开发上线一个对接了openAI的机器人</div><a class="blog-slider__button" href="posts/2a9d73ff/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo3.jpg" alt="/img/nba-logo3.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2023-06-14</span><a class="blog-slider__title" href="posts/aa43cc95/">记录k8s环境下结合alinode的使用</a><div class="blog-slider__text">记录k8s环境下结合alinode的使用</div><a class="blog-slider__button" href="posts/aa43cc95/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo29.jpg" alt="/img/nba-logo29.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2022-12-13</span><a class="blog-slider__title" href="posts/15957791/">k8s环境下,nginx做websocket负载的方案梳理</a><div class="blog-slider__text">k8s环境下,nginx做websocket负载的方案梳理</div><a class="blog-slider__button" href="posts/15957791/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo12.jpg" alt="/img/nba-logo12.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2023-09-26</span><a class="blog-slider__title" href="posts/4ecfb081/">记录一次k8s网络DNS问题排查过程</a><div class="blog-slider__text">记录一次k8s网络DNS问题排查过程</div><a class="blog-slider__button" href="posts/4ecfb081/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo12.jpg" alt="/img/nba-logo12.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2023-09-26</span><a class="blog-slider__title" href="posts/37032a87/">k3s高可用安装</a><div class="blog-slider__text">k3s高可用安装</div><a class="blog-slider__button" href="posts/37032a87/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo17.jpg" alt="/img/nba-logo17.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2022-11-27</span><a class="blog-slider__title" href="posts/20b19ed4/">分词搜索需求整理</a><div class="blog-slider__text">分词搜索需求整理</div><a class="blog-slider__button" href="posts/20b19ed4/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo9.jpg" alt="/img/nba-logo9.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2022-12-02</span><a class="blog-slider__title" href="posts/6de14387/">整理wsl2配合开发的一些配置</a><div class="blog-slider__text">整理wsl2配合开发的一些配置</div><a class="blog-slider__button" href="posts/6de14387/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo30.jpg" alt="/img/nba-logo30.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2021-12-11</span><a class="blog-slider__title" href="posts/fb9adcb6/">记录windows11+wsl2环境搭配</a><div class="blog-slider__text">windows11+wsl2开发环境配置</div><a class="blog-slider__button" href="posts/fb9adcb6/">详情</a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';console.log("已挂载swiper"),parent.insertAdjacentHTML("afterbegin",child)}</script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper/swiper/swiper.min.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper@0.18/swiper/swiperindex.js"></script><style></style><script data-pjax>function history_calendar_injector_config(){var i=document.getElementsByClassName("sticky_layout")[0];console.log("已挂载history_calendar"),i.insertAdjacentHTML("afterbegin",'<div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span>那年今日</span></div><div id="history-baidu" style="height: 100px;overflow: hidden"><div class="history_swiper-container" id="history-container" style="width: 100%;height: 100%"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div>')}document.getElementsByClassName("sticky_layout")[0]&&"/"===location.pathname&&history_calendar_injector_config()</script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/wanko.model.json"},display:{position:"right",width:150,height:300,hOffset:20,vOffset:-20},mobile:{show:!0},log:!1,pluginJsPath:"lib/",pluginModelPath:"assets/",pluginRootPath:"live2dw/"})</script></body></html>