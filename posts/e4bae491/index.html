<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>MapStruct的使用 | 小五的个人杂货铺</title><meta name="author" content="小五"><meta name="copyright" content="小五"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="MapStruct是一个代码生成库，简化了Java对象到Java对象之间的映射过程。通过注解接口，它可以自动生成转换代码，支持多种映射场景，如属性映射、定制方法、目标对象更新等。此外，还支持数据类型转换、嵌套对象映射和使用上下文对象定制转换。在Spring项目中，可通过Maven&#x2F;Gradle依赖和配置进行集成。 注：MapStruct 从版本 1.2.0.Beta1 开始支持与 Lo"><meta property="og:type" content="article"><meta property="og:title" content="MapStruct的使用"><meta property="og:url" content="https://xiaowu95.wang/posts/e4bae491/"><meta property="og:site_name" content="小五的个人杂货铺"><meta property="og:description" content="MapStruct是一个代码生成库，简化了Java对象到Java对象之间的映射过程。通过注解接口，它可以自动生成转换代码，支持多种映射场景，如属性映射、定制方法、目标对象更新等。此外，还支持数据类型转换、嵌套对象映射和使用上下文对象定制转换。在Spring项目中，可通过Maven&#x2F;Gradle依赖和配置进行集成。 注：MapStruct 从版本 1.2.0.Beta1 开始支持与 Lo"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://xiaowu95.wang/img/nba-logo30.jpg"><meta property="article:published_time" content="2025-07-04T01:24:34.000Z"><meta property="article:modified_time" content="2025-07-04T01:24:34.000Z"><meta property="article:author" content="小五"><meta property="article:tag" content="java"><meta property="article:tag" content="springboot"><meta property="article:tag" content="MapStruct"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://xiaowu95.wang/img/nba-logo30.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://xiaowu95.wang/posts/e4bae491/"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google-site-verification" content="kHfLZxYQ7y3s3AR7gyJDdJkQvGNjQsvopp6N3gEEx0s"><meta name="baidu-site-verification" content="codeva-aVS4F6wAjS"><link rel="manifest" href="/wang-xiaowu/pwa/site.webmanifest"><meta name="msapplication-TileColor" content="#fff"><link rel="apple-touch-icon" sizes="180x180" href="/wang-xiaowu/pwa/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/wang-xiaowu/pwa/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/wang-xiaowu/pwa/favicon-16x16.png"><link rel="mask-icon" href="/wang-xiaowu/pwa/safari-pinned-tab.svg" color="#5bbad5"><link rel="stylesheet" href="/css/index.css?v=5.2.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.36/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>(()=>{const t={set:(e,t,o)=>{if(!o)return;const a=Date.now()+864e5*o;localStorage.setItem(e,JSON.stringify({value:t,expiry:a}))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const{value:o,expiry:a}=JSON.parse(t);if(!(Date.now()>a))return o;localStorage.removeItem(e)}};window.btf={saveToLocal:t,getScript:(e,t={})=>new Promise(((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,Object.entries(t).forEach((([e,t])=>n.setAttribute(e,t))),n.onload=n.onreadystatechange=()=>{n.readyState&&!/loaded|complete/.test(n.readyState)||o()},n.onerror=a,document.head.appendChild(n)})),getCSS:(e,t)=>new Promise(((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onload=n.onreadystatechange=()=>{n.readyState&&!/loaded|complete/.test(n.readyState)||o()},n.onerror=a,document.head.appendChild(n)})),addGlobalFn:(e,t,o=!1,a=window)=>{const n=a.globalFn||{};n[e]=n[e]||{},n[e][o||Object.keys(n[e]).length]=t,a.globalFn=n}};const o=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},a=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};btf.activateDarkMode=o,btf.activateLightMode=a;const n=t.get("theme"),c=window.matchMedia("(prefers-color-scheme: dark)"),r=window.matchMedia("(prefers-color-scheme: light)");if(void 0===n){if(r.matches)a();else if(c.matches)o();else{const e=(new Date).getHours();e<=6||e>=18?o():a()}c.addEventListener("change",(()=>{void 0===t.get("theme")&&(e.matches?o():a())}))}else"light"===n?a():o();const d=t.get("aside-status");void 0!==d&&document.documentElement.classList.toggle("hide-aside","hide"===d);/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})()</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?86cb34987e15c900c39e12ebdf08c50d";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),btf.addGlobalFn("pjaxComplete",(()=>{_hmt.push(["_trackPageview",window.location.pathname])}),"baidu_analytics")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-1MFQ47191J"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-1MFQ47191J"),btf.addGlobalFn("pjaxComplete",(()=>{gtag("config","G-1MFQ47191J",{page_path:window.location.pathname})}),"google_analytics")</script><script>const GLOBAL_CONFIG={root:"/",algolia:{appId:"M91QAWRVY4",apiKey:"ecc30a5e06136e1cc491685e39801190",indexName:"xiaowu-blog",hitsPerPage:6,languages:{input_placeholder:"搜索文章",hits_empty:"未找到符合您查询的内容：${query}",hits_stats:"找到 ${hits} 条结果，耗时 ${time} 毫秒"}},localSearch:void 0,translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"簡"},highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:400,highlightFullpage:!0,highlightMacStyle:!0},copy:{success:"复制成功",error:"复制失败",noSupport:"浏览器不支持"},relativeDate:{homepage:!0,post:!0},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:150,languages:{author:"作者: 小五",link:"链接: ",source:"来源: 小五的个人杂货铺",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"已切换为繁体中文",cht_to_chs:"已切换为简体中文",day_to_night:"已切换为深色模式",night_to_day:"已切换为浅色模式",bgLight:"#49b1f5",bgDark:"#1f1f1f",position:"bottom-left"},infinitegrid:{js:"https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!0,percent:{toc:!0,rightside:!0},autoDarkmode:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"MapStruct的使用",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,isShuoshuo:!1}</script><script src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script src="https://npm.elemecdn.com/echarts@4.9.0/dist/echarts.min.js"></script><link rel="stylesheet" href="/css/font.css"><style>.app-refresh{position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease}.app-refresh-wrap{display:flex;color:#fff;height:100%;align-items:center;justify-content:center}.app-refresh-wrap a{color:#fff;text-decoration:underline;cursor:pointer}</style><link rel="stylesheet" href="/css/titleStyle.css"><link rel="stylesheet" href="/css/mouse.css"><link rel="stylesheet" href="/css/custom.css"><style>.card-announcement .social-button{margin:.6rem 0 0 0;text-align:center}.card-announcement .social-button a{display:block;background-color:var(--btn-bg);color:var(--btn-color);text-align:center;line-height:2.4;margin:4px 0}.card-announcement .social-button a:hover{background-color:var(--btn-hover-color)}</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper/swiper/swiper.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper/swiper/swiperstyle.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css"><link rel="alternate" href="/atom.xml" title="小五的个人杂货铺" type="application/atom+xml"></head><body><script>window.paceOptions={restartOnPushState:!1},btf.addGlobalFn("pjaxSend",(()=>{Pace.restart()}),"pace_restart")</script><link rel="stylesheet" href="/css/pace.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/loading.gif" data-lazy-src="/img/avatar.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">550</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">163</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">58</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/github/"><i class="fa-fw fa-solid fa-address-card"></i> <span>关于我</span></a></div><div class="menus_item"><a class="site-page" href="/ac/"><i class="fa-fw fa-solid fa-wind"></i> <span>便携小空调</span></a></div><div class="menus_item"><a class="site-page" href="/talking/"><i class="fa-fw fa-solid fa-walkie-talkie"></i> <span>博客短记</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-compass"></i> <span>目录</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-otter"></i> <span>杂记</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/songs/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i> <span>图库</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fa-solid fa-film"></i> <span>影视|番剧</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book faa-fload"></i> <span>书单</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad faa-fload"></i> <span>游戏</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fa-brands fa-bilibili"></i> <span>BiliBili追番</span></a></li><li><a class="site-page child" href="/cinemas/"><i class="fa-fw fa-solid fa-video"></i> <span>BiliBili追剧</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-comment-dots"></i> <span>留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-user-group"></i> <span>友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-mug-saucer"></i> <span>Website Memo</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://console.leancloud.app/apps"><span>🚀 LeanCloud</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://vercel.com/dashboard"><span>🚀 Vercel</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://tongji.baidu.com/main/overview/10000432799/overview/index"><span>🚀 百度统计</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://ziyuan.baidu.com/dashboard/index"><span>🚀 百度站点管理</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://analytics.google.com/analytics/web/"><span>🚀 谷歌分析</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://search.google.com/search-console?hl=zh-cn"><span>🚀 谷歌站点管理</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.google.com/adsense/new/u/0/pub-1375421173355613/home"><span>🚀 谷歌广告联盟</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.algolia.com/"><span>🚀 Algolia</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://sms-activate.org/cn/"><span>🚀 Sms-activate</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://chatgpt.com/"><span>🚀 ChatGPT</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://poe.com/"><span>🚀 Poe聚合</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="http://www.idc.net/clientarea"><span>🚀 后浪云</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.west.cn/"><span>🚀 西部数据</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://shandianpro.com/#/dashboard"><span>🚀 闪电</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.huojian.homes/"><span>🚀 小火箭</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/winston779/gougou"><span>🚀 狗狗加速</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/img/nba-logo30.jpg)"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">小五的个人杂货铺</span></a><a class="nav-page-title" href="/"><span class="site-name">MapStruct的使用</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>首页</span></a></div><div class="menus_item"><a class="site-page" href="/github/"><i class="fa-fw fa-solid fa-address-card"></i> <span>关于我</span></a></div><div class="menus_item"><a class="site-page" href="/ac/"><i class="fa-fw fa-solid fa-wind"></i> <span>便携小空调</span></a></div><div class="menus_item"><a class="site-page" href="/talking/"><i class="fa-fw fa-solid fa-walkie-talkie"></i> <span>博客短记</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-compass"></i> <span>目录</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>分类</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-otter"></i> <span>杂记</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/songs/"><i class="fa-fw fas fa-music"></i> <span>音乐</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i> <span>图库</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fa-solid fa-film"></i> <span>影视|番剧</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book faa-fload"></i> <span>书单</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad faa-fload"></i> <span>游戏</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fa-brands fa-bilibili"></i> <span>BiliBili追番</span></a></li><li><a class="site-page child" href="/cinemas/"><i class="fa-fw fa-solid fa-video"></i> <span>BiliBili追剧</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-comment-dots"></i> <span>留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-user-group"></i> <span>友链</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-mug-saucer"></i> <span>Website Memo</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://console.leancloud.app/apps"><span>🚀 LeanCloud</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://vercel.com/dashboard"><span>🚀 Vercel</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://tongji.baidu.com/main/overview/10000432799/overview/index"><span>🚀 百度统计</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://ziyuan.baidu.com/dashboard/index"><span>🚀 百度站点管理</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://analytics.google.com/analytics/web/"><span>🚀 谷歌分析</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://search.google.com/search-console?hl=zh-cn"><span>🚀 谷歌站点管理</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.google.com/adsense/new/u/0/pub-1375421173355613/home"><span>🚀 谷歌广告联盟</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.algolia.com/"><span>🚀 Algolia</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://sms-activate.org/cn/"><span>🚀 Sms-activate</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://chatgpt.com/"><span>🚀 ChatGPT</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://poe.com/"><span>🚀 Poe聚合</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="http://www.idc.net/clientarea"><span>🚀 后浪云</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.west.cn/"><span>🚀 西部数据</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://shandianpro.com/#/dashboard"><span>🚀 闪电</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.huojian.homes/"><span>🚀 小火箭</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/winston779/gougou"><span>🚀 狗狗加速</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">MapStruct的使用<a class="post-edit-link" href="https://github.com/wang-xiaowu/wang-xiaowu.github.io/issues/new?_posts/spring/mapstruct的使用.md" rel="external nofollow noreferrer" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-04T01:24:34.000Z" title="发表于 2025-07-04 09:24:34">2025-07-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-04T01:24:34.000Z" title="更新于 2025-07-04 09:24:34">2025-07-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/spring/">spring</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">7.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>31分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:365,&quot;messagePrev&quot;:&quot;距离上一次更新该文章已经过了&quot;,&quot;messageNext&quot;:&quot;天，文章所描述的內容可能已经发生变化，请留意。&quot;,&quot;postUpdate&quot;:&quot;2025-07-04 09:24:34&quot;}" hidden></div><blockquote><p>MapStruct是一个代码生成库，简化了Java对象到Java对象之间的映射过程。通过注解接口，它可以自动生成转换代码，支持多种映射场景，如属性映射、定制方法、目标对象更新等。此外，还支持数据类型转换、嵌套对象映射和使用上下文对象定制转换。在Spring项目中，可通过Maven&#x2F;Gradle依赖和配置进行集成。</p><p>注：MapStruct 从版本 1.2.0.Beta1 开始支持与 Lombok 整合，利用 Lombok 生成的 getter、setter 和构造函数来生成映射实现。</p></blockquote><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h2 id="Maven"><a href="#Maven" class="headerlink" title="Maven"></a><strong>Maven</strong></h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mapstruct<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapstruct<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mapstruct.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">annotationProcessorPaths</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">path</span>&gt;</span>                        </span><br><span class="line">				<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mapstruct<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line">				<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapstruct-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mapstruct.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;/<span class="name">path</span>&gt;</span>                    </span><br><span class="line">	    <span class="tag">&lt;<span class="name">path</span>&gt;</span>                        </span><br><span class="line">				<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">	    <span class="tag">&lt;/<span class="name">path</span>&gt;</span>                    </span><br><span class="line">	    <span class="tag">&lt;<span class="name">path</span>&gt;</span>                        </span><br><span class="line">		    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span>  </span><br><span class="line">				<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok-mapstruct-binding<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span>  </span><br><span class="line">				<span class="tag">&lt;<span class="name">version</span>&gt;</span>0.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span>  </span><br><span class="line">			<span class="tag">&lt;/<span class="name">path</span>&gt;</span>                </span><br><span class="line">    <span class="tag">&lt;/<span class="name">annotationProcessorPaths</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Gradle"><a href="#Gradle" class="headerlink" title="Gradle"></a>Gradle</h2><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">&quot;org.mapstruct:mapstruct:$&#123;mapstructVersion&#125;&quot;</span></span><br><span class="line">compileOnly <span class="string">&quot;org.projectlombok:lombok&quot;</span></span><br><span class="line">annotationProcessor <span class="string">&quot;org.mapstruct:mapstruct-processor:$&#123;mapstructVersion&#125;&quot;</span></span><br><span class="line">annotationProcessor <span class="string">&quot;org.projectlombok:lombok-mapstruct-binding:$&#123;lombokMapstructBindingVersion&#125;&quot;</span></span><br><span class="line">annotationProcessor <span class="string">&quot;org.projectlombok:lombok&quot;</span></span><br></pre></td></tr></table></figure><h1 id="创建映射接口（普通使用）"><a href="#创建映射接口（普通使用）" class="headerlink" title="创建映射接口（普通使用）"></a>创建映射接口（普通使用）</h1><p>创建一个Java接口，并使用<code>@Mapper</code>注解标记它。例如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyMapper</span> &#123;</span><br><span class="line">    <span class="type">MyMapper</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(MyMapper.class);</span><br><span class="line"></span><br><span class="line">    TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br><span class="line">    <span class="comment">// 定义其他映射方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上述代码定义了一个映射接口<code>MyMapper</code>，其中有一个映射方法<code>sourceToTarget</code>用于将<code>SourceObject</code>映射为<code>TargetObject</code>。<code>INSTANCE</code>字段用于获取映射器的实例。</p><p>此时我们编译项目之后，可以看见生成的<code>MyMapper</code>实现类中的代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span>  </span><br><span class="line"><span class="keyword">public</span> TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span> &#123;  </span><br><span class="line">    <span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TargetObject</span>();  </span><br><span class="line">  </span><br><span class="line">    targetObject.setUserName( source.getUserName() );  </span><br><span class="line">    targetObject.setUserId( source.getUserId() );  </span><br><span class="line">    targetObject.setSex( source.getSex() );  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> targetObject;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样就省去了我们自己手写两个对象之间的字段映射，避免了大量的重复工作，大大增加了开发效率，其次也是最重要的一点就是我们可以很直观的看见两个对象之间的字段映射关系，不像<code>Dozer</code>那样每次基于反射区实现映射，我们无法看见两边的字段的映射，出现问题后不方便排查，功能上不可控。</p><blockquote><p>很重要的一点提示：我们要养成在写完一个映射方法后，要养成一定一定提前编译看一下生成的实现类方法是否正确，同时也看看是否存在字段映射关系设置错误导致编译不通过。</p></blockquote><h2 id="映射接口使用"><a href="#映射接口使用" class="headerlink" title="映射接口使用"></a>映射接口使用</h2><p>在业务代码或者其他代码方法中，我们可以直接使用<code>MyConverter.INSTANCE.sourceToTarget(source)</code>进行<code>source</code>与<code>target</code>之间的转换。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TargetObject <span class="title function_">handleObject</span><span class="params">(SourceObject source)</span>&#123;  </span><br><span class="line">    <span class="keyword">return</span> MyConverter.INSTANCE.sourceToTarget(source);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="MapStruct常用注解"><a href="#MapStruct常用注解" class="headerlink" title="MapStruct常用注解"></a>MapStruct常用注解</h1><p>了解MapStruct的注解及其属性是非常重要的，因为它们定义了映射规则和行为。以下是MapStruct中常用的注解及其属性：</p><h2 id="Mapper"><a href="#Mapper" class="headerlink" title="@Mapper"></a><code>@Mapper</code></h2><p>用于标记一个接口或抽象类，用于定义对象之间的映射规则。它有多个属性可以配置映射器的功能。以下是 <code>@Mapper</code> 注解的一些常用属性：</p><h3 id="componentModel"><a href="#componentModel" class="headerlink" title="componentModel"></a><code>componentModel</code></h3><p>指定生成的映射器实例的组件模型,以便与应用框架集成。他有&quot;default&quot;（默认值）、&quot;cdi&quot;、&quot;spring&quot;等可选值（具体参考<code>MappingConstants.ComponentModel</code>）。我们着重介绍一下default以及spring：</p><ul><li>default：<code>MapStruct</code>的默认组件模型<br>在默认模式下，MapStruct 会生成一个无参数的构造函数的映射器实例。映射器实例的创建和管理由 <code>MapStruct</code>自动处理。实例通常通过 <code>Mappers.getMapper（Class）</code>获取。适用于简单的映射场景，无需额外的依赖注入或容器管理。</li><li>spring：使用<code>Spring Framework</code>的组件模型<br>在 Spring 模式下，MapStruct 会生成一个使用 <code>@Component</code> 注解标记的映射器实例，从而允许通过 Spring 的 IoC 容器进行管理和依赖注入。适用于 Spring 框架中的应用，可以利用 Spring 的依赖注入功能。稍后我们会介绍这种模型的使用，也是我们日常使用<code>SpringBoot</code>开发时用的比较多的模型。比如上例中，我们使用spring的模型，则生成的代码：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MySpringMapperImpl</span> <span class="keyword">implements</span> <span class="title class_">MySpringMapper</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="keyword">public</span> TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span> &#123;  </span><br><span class="line">        <span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">        <span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TargetObject</span>();  </span><br><span class="line">  </span><br><span class="line">        targetObject.setUserName( source.getUserName() );  </span><br><span class="line">        targetObject.setUserId( source.getUserId() );  </span><br><span class="line">        targetObject.setSex( source.getSex() );  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> targetObject;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看见实现类中自动加上了<code>@Component</code>，注入到Spring的容器中管理。</p><ul><li>cdi：使用 Contexts and Dependency Injection (CDI) 的组件模型。<br>在 CDI 模式下，MapStruct 会生成一个使用 <code>@Dependent</code> 注解标记的映射器实例，允许通过 CDI 容器进行管理和依赖注入。适用于<code>Java EE</code> 或<code>Jakarta EE</code>中使用 CDI 的应用，可以利用 CDI 容器进行管理。</li></ul><p>其余的大家感兴趣的可以去阅读源码，平时使用不多，这里就不过多介绍了。</p><h3 id="uses"><a href="#uses" class="headerlink" title="uses"></a>uses</h3><p>指定映射器使用的自定义转换器。自定义转换器是在映射过程中调用的方法，用于处理特定类型之间的自定义映射逻辑。如果我们两个对象之间有一个字段的属性值需要特殊处理之后在进行映射，即需要加上一些转换逻辑，我们就可以自定义一个转换器，然后在映射器中使用转换器中的方法。例如：SoureObject中的有一个枚举值，但是转换到TargetObject中时需要转换为具体的说明，那么此时我们就可以使用自定义转换器。</p><p>我们自定义一个转换器，并且定义一个转换方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConverter</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Named(&quot;convertSexDesc&quot;)</span>  </span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">convertSexDesc</span><span class="params">(Integer sex)</span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> SexEnum.descOfCode(sex);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后再映射器<code>MyMapper</code>中使用<code>uses</code>指定转换器，同时使用<code>@Mapping</code>注解指定两个字段的映射规则：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper(uses = &#123;MyConverter.class&#125;)</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyMapper</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="type">MyMapper</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(MyMapper.class);  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Mapping(target = &quot;sex&quot;, source = &quot;sex&quot;, qualifiedByName = &quot;convertSexDesc&quot;)</span>  </span><br><span class="line">    TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译后可以看见实现类中生成的代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyMapperImpl</span> <span class="keyword">implements</span> <span class="title class_">MyMapper</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">MyConverter</span> <span class="variable">myConverter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyConverter</span>();  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="keyword">public</span> TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span> &#123;  </span><br><span class="line">        <span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">        <span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TargetObject</span>();  </span><br><span class="line">  </span><br><span class="line">        targetObject.setSex( myConverter.convertSexDesc( source.getSex() ) );  </span><br><span class="line">        targetObject.setUserName( source.getUserName() );  </span><br><span class="line">        targetObject.setUserId( source.getUserId() );  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> targetObject;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当然假如你的转换器或者转换方法，是你这个映射器独有，其他映射器不会使用这个转换方法，那么你可以直接在<code>MyMapper</code>中定义一个<code>default</code>的转换方法，就不必使用<code>uses</code>引入转换器：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyMapper</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="type">MyMapper</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(MyMapper.class);  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Mapping(target = &quot;sex&quot;, source = &quot;sex&quot;, qualifiedByName = &quot;convertSexDesc&quot;)</span>  </span><br><span class="line">    TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Named(&quot;convertSexDesc&quot;)</span>  </span><br><span class="line">    <span class="keyword">default</span> String <span class="title function_">convertSexDesc</span><span class="params">(Integer sex)</span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> SexEnum.descOfCode(sex);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译后生成的实现类中，直接可以调用到这个方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyMapperImpl</span> <span class="keyword">implements</span> <span class="title class_">MyMapper</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="keyword">public</span> TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span> &#123;  </span><br><span class="line">        <span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">        <span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TargetObject</span>();  </span><br><span class="line">  </span><br><span class="line">        targetObject.setSex( convertSexDesc( source.getSex() ) );  </span><br><span class="line">        targetObject.setUserName( source.getUserName() );  </span><br><span class="line">        targetObject.setUserId( source.getUserId() );  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> targetObject;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>在Java中，接口可以包含默认方法（Default Methods）。默认方法是在接口中提供一个默认的实现，这样在接口的实现类中就不需要强制性地实现该方法了。默认方法使用关键字 <code>default</code> 进行声明。</p></blockquote><h3 id="imports"><a href="#imports" class="headerlink" title="imports"></a>imports</h3><p>导入其他类的全限定名，使其在生成的映射器接口中可见。比如我们可以导入其他的工具类去处理我们的字段，例如:<code>StringUtils</code>, <code>CollectionUtils</code>，<code>MapUtils</code>,或者一些枚举类等。同常运用<code>@Mapping</code>中的<code>expression</code>上。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper(imports = &#123;StringUtils.class, SexEnum.class&#125;)</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyMapper</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="type">MyMapper</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(MyMapper.class);  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Mapping(target = &quot;sex&quot;,  expression = &quot;java(SexEnum.descOfCode(source.getSex()))&quot;)</span>  </span><br><span class="line">    TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure><p>编译后生成的实现类中直接<code>import</code>了<code>imports</code>中定义的类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.springboot.code.mapstruct.SexEnum;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyMapperImpl</span> <span class="keyword">implements</span> <span class="title class_">MyMapper</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="keyword">public</span> TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span> &#123;  </span><br><span class="line">        <span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">        <span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TargetObject</span>();  </span><br><span class="line">  </span><br><span class="line">        targetObject.setUserName( source.getUserName() );  </span><br><span class="line">        targetObject.setUserId( source.getUserId() );  </span><br><span class="line">  </span><br><span class="line">        targetObject.setSex( SexEnum.descOfCode(source.getSex()) );  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> targetObject;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当然我们也可以不使用<code>imports</code>去导入其他的类，那我们在使用这些类的方法时，必须写上他们的全路径:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyMapper</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="type">MyMapper</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(MyMapper.class);  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Mapping(target = &quot;sex&quot;,  expression = &quot;java(com.springboot.code.mapstruct.SexEnum.descOfCode(source.getSex()))&quot;)</span>  </span><br><span class="line">    TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure><p>编译后生成的实现类中，就不会<code>import</code>类了：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyMapperImpl</span> <span class="keyword">implements</span> <span class="title class_">MyMapper</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="keyword">public</span> TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span> &#123;  </span><br><span class="line">        <span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">        <span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TargetObject</span>();  </span><br><span class="line">  </span><br><span class="line">        targetObject.setUserName( source.getUserName() );  </span><br><span class="line">        targetObject.setUserId( source.getUserId() );  </span><br><span class="line">  </span><br><span class="line">        targetObject.setSex( com.springboot.code.mapstruct.SexEnum.descOfCode(source.getSex()) );  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> targetObject;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="config"><a href="#config" class="headerlink" title="config"></a>config</h3><p><code>config</code> 属性允许你指定一个映射器配置类，该配置类用于提供全局的配置选项。通过配置类，你可以定义一些全局行为，例如处理 <code>null</code> 值的策略、映射器名称、映射器组件模型等。</p><p>我们使用<code>@MapperConfig</code>定义一个映射器配置类 <code>MyMapperConfig</code>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapperConfig(  </span></span><br><span class="line"><span class="meta">        nullValueCheckStrategy = NullValueCheckStrategy.ALWAYS,  </span></span><br><span class="line"><span class="meta">        componentModel = &quot;default&quot;,  </span></span><br><span class="line"><span class="meta">        uses = MyConverter.class,  </span></span><br><span class="line"><span class="meta">        unmappedTargetPolicy = org.mapstruct.ReportingPolicy.WARN  </span></span><br><span class="line"><span class="meta">)</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyMapperConfig</span> &#123;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后再<code>MyMapper</code>中指定config：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper(config = MyMapperConfig.class)</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyMapper</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="type">MyMapper</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(MyMapper.class);  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Mapping(target = &quot;sex&quot;, source = &quot;sex&quot;, qualifiedByName = &quot;convertSexDesc&quot;)</span>  </span><br><span class="line">    TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br><span class="line"> &#125;   </span><br></pre></td></tr></table></figure><p>我们可以集中管理映射器的一些全局行为，而不需要在每个映射器中重复配置。<br>在实际应用中，你可以根据项目需求定义不同的映射器配置类，用于管理不同的全局配置选项。这有助于提高代码的组织性和可维护性。</p><h3 id="nullValueCheckStrategy"><a href="#nullValueCheckStrategy" class="headerlink" title="nullValueCheckStrategy"></a>nullValueCheckStrategy</h3><p>用于指定映射器对源对象字段的<code>null</code>值进行检查的策略。检查策略枚举类<code>NullValueCheckStrategy</code>值如下：</p><ul><li>ALWAYS：始终对源值进行<code>NULL</code>检查。<br>生成的实现类中，都是源值进行判<code>NULL</code>：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span>  </span><br><span class="line"><span class="keyword">public</span> TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span> &#123;  </span><br><span class="line">    <span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TargetObject</span>();  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span> ( source.getSex() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">        targetObject.setSex( myConverter.convertSexDesc( source.getSex() ) );  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">if</span> ( source.getUserName() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">        targetObject.setUserName( source.getUserName() );  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">if</span> ( source.getUserId() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">        targetObject.setUserId( source.getUserId() );  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> targetObject;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ON_IMPLICIT_CONVERSION：不检查<code>NULL</code>值，直接将源值赋值给目标值</li></ul><p>除了上述的属性值之外，还有一些其他的属性值，例如：</p><ul><li><code>unmappedSourcePolicy</code>： 未映射源对象字段的处理策略。</li><li><code>unmappedTargetPolicy</code>： 未映射目标对象字段的处理策略。<br>可选值：<code>ReportingPolicy.IGNORE</code>（忽略未映射字段，默认）、<code>ReportingPolicy.WARN</code>（警告）、<code>ReportingPolicy.ERROR</code>（抛出错误）。</li></ul><p>以及其他的一些属性值，如果需要用到的同学，可以看一下源码中的介绍，这里就不过多叙述了。</p><h2 id="MapperConfig"><a href="#MapperConfig" class="headerlink" title="@MapperConfig"></a><code>@MapperConfig</code></h2><p>注解用于定义映射器配置类，它允许在一个单独的配置类中集中管理映射器的全局配置选项。可以将一些全局的配置选项集中在一个配置类中，使得映射器的配置更为清晰和可维护。在实际应用中，可以根据需要定义不同的映射器配置类，以便在不同的场景中使用。配置类可以在映射器中通过<code>@Mapper</code>的<code>config</code>属性引入。它大部分的属性值跟<code>@Mapper</code>一致。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapperConfig(  </span></span><br><span class="line"><span class="meta">        nullValueCheckStrategy = NullValueCheckStrategy.ON_IMPLICIT_CONVERSION,  </span></span><br><span class="line"><span class="meta">        componentModel = &quot;default&quot;,  </span></span><br><span class="line"><span class="meta">        uses = MyConverter.class,  </span></span><br><span class="line"><span class="meta">        unmappedTargetPolicy = org.mapstruct.ReportingPolicy.WARN  </span></span><br><span class="line"><span class="meta">)</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyMapperConfig</span> &#123;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后再<code>MyMapper</code>中指定config：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper(config = MyMapperConfig.class)</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyMapper</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="type">MyMapper</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(MyMapper.class);  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Mapping(target = &quot;sex&quot;, source = &quot;sex&quot;, qualifiedByName = &quot;convertSexDesc&quot;)</span>  </span><br><span class="line">    TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br><span class="line"> &#125; </span><br></pre></td></tr></table></figure><h2 id="Mapping"><a href="#Mapping" class="headerlink" title="@Mapping"></a><code>@Mapping</code></h2><p>用于自定义映射器方法中的映射规则。它允许你指定源对象和目标对象之间字段的映射关系。</p><h3 id="source-和-target"><a href="#source-和-target" class="headerlink" title="source 和 target:"></a><code>source</code> 和 <code>target</code>:</h3><ul><li><strong><code>source</code> 含义：</strong> 源对象字段的名称或表达式。</li><li><strong><code>target</code> 含义：</strong> 目标对象字段的名称。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapping(target = &quot;sourceField&quot;, source = &quot;sourceField&quot;)</span>  </span><br><span class="line">TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br></pre></td></tr></table></figure><p>或者使用表达式的方式：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapping(expression = &quot;java(source.getSourceField())&quot;, target = &quot;targetField&quot;)</span></span><br><span class="line">TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br></pre></td></tr></table></figure><h3 id="qualifiedByName-和-qualifiedBy"><a href="#qualifiedByName-和-qualifiedBy" class="headerlink" title="qualifiedByName 和 qualifiedBy:"></a><code>qualifiedByName</code> 和 <code>qualifiedBy</code>:</h3><ul><li><code>qualifiedByName</code>： 指定使用自定义转换器方法进行映射。</li></ul><p>定义一个转换器<code>MyNameConverter</code>:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyNameConverter</span> &#123;  </span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Named(&quot;convertUserName&quot;)</span>  </span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">convertUserName</span><span class="params">(String userName)</span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> Optional.ofNullable(userName).map(String::toUpperCase).orElse(userName);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用自定义转换器的方法:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper( uses = &#123;MyNameConverter.class&#125;, nullValueCheckStrategy = NullValueCheckStrategy.ALWAYS)</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyMapper</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="type">MyMapper</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(MyMapper.class);  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Mapping(target = &quot;userName&quot;, source = &quot;userName&quot;, qualifiedByName = &quot;convertUserName&quot;)</span>  </span><br><span class="line">    TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br></pre></td></tr></table></figure><ul><li><code>qualifiedBy</code>： 指定使用基于<code>@qualifier</code>注解的转换方法</li></ul><p>先定义一个基于<code>@qualifier</code>(mapstruct包下)的作用于转换器类上的注解<code>@StrConverter</code>:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Qualifier</span>  </span><br><span class="line"><span class="meta">@Target(ElementType.TYPE)</span>  </span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.CLASS)</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> StrConverter &#123;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再定义一个基于<code>@qualifier</code>(mapstruct包下)的作用于转换器方法上的注解<code>@NameUpper</code>:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Qualifier</span>  </span><br><span class="line"><span class="meta">@Target(ElementType.METHOD)</span>  </span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.CLASS)</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> NameUpper &#123;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后定义一个自定义转换器<code>MyNameConverter</code>:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@StrConverter</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyNameConverter</span> &#123;  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@NameUpper</span>  </span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">convertUserName</span><span class="params">(String userName)</span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> Optional.ofNullable(userName).map(String::toUpperCase).orElse(userName);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后我们在<code>@Mappinbg</code>中通过使用：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper(uses = &#123;MyNameConverter.class&#125; ,nullValueCheckStrategy = NullValueCheckStrategy.ALWAYS)</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyMapper</span> &#123;</span><br><span class="line">	<span class="meta">@Mapping(target = &quot;userName&quot;, source = &quot;userName&quot;, qualifiedBy = NameUpper.class)</span> </span><br><span class="line">	TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最终两种方式编译后的结果是一致的：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyMapperImpl</span> <span class="keyword">implements</span> <span class="title class_">MyMapper</span> &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">MyNameConverter</span> <span class="variable">myNameConverter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyNameConverter</span>();  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span>  </span><br><span class="line">    <span class="keyword">public</span> TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span> &#123;  </span><br><span class="line">        <span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">        <span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TargetObject</span>();  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">if</span> ( source.getUserName() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">            targetObject.setUserName( myNameConverter.convertUserName( source.getUserName() ) );  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">if</span> ( source.getUserId() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">            targetObject.setUserId( source.getUserId() );  </span><br><span class="line">        &#125;  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> targetObject;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>以上基于qualifiedBy的使用示例参考自@Qualifier源码文档。</p></blockquote><h3 id="ignore"><a href="#ignore" class="headerlink" title="ignore"></a><code>ignore</code></h3><p>是否忽略某字段的映射。为true时忽略。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapping(target = &quot;sex&quot;, source = &quot;sex&quot;, ignore = true)</span></span><br><span class="line">TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br></pre></td></tr></table></figure><p>编译后实现类中不会对这个字段进行赋值：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span>  </span><br><span class="line"><span class="keyword">public</span> TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span> &#123;  </span><br><span class="line">    <span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TargetObject</span>();  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span> ( source.getUserName() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">        targetObject.setUserName( source.getUserName() );  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">if</span> ( source.getUserId() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">        targetObject.setUserId( source.getUserId() );  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> targetObject;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="defaultExpression"><a href="#defaultExpression" class="headerlink" title="defaultExpression"></a><code>defaultExpression</code></h3><p>指定默认表达式，当源对象字段为 <code>null</code> 时使用。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapping(target = &quot;sex&quot;, source = &quot;sex&quot;, defaultExpression = &quot;java(SexEnum.MAN.desc)&quot;)</span></span><br><span class="line">TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br></pre></td></tr></table></figure><p>编译后实现类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( source.getSex() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">       targetObject.setSex( String.valueOf( source.getSex() ) );  </span><br><span class="line"> &#125;  </span><br><span class="line"> <span class="keyword">else</span> &#123;  </span><br><span class="line">   targetObject.setSex( SexEnum.MAN.desc );  </span><br><span class="line"> &#125; </span><br></pre></td></tr></table></figure><blockquote><p>defaultExpression不能与expression，defaultValue，constant一起使用。</p></blockquote><h3 id="defaultValue"><a href="#defaultValue" class="headerlink" title="defaultValue"></a><code>defaultValue</code></h3><p>指定默认值，当源对象字段为 <code>null</code> 时使用。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapping(target = &quot;sex&quot;, source = &quot;sex&quot;, defaultValue = &quot;男人&quot;)</span>  </span><br><span class="line">TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br></pre></td></tr></table></figure><p>编译后：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( source.getSex() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">    targetObject.setSex( String.valueOf( source.getSex() ) );  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">else</span> &#123;  </span><br><span class="line">    targetObject.setSex( <span class="string">&quot;男人&quot;</span> );  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>defaultValue不能与expression，defaultExpression，constant一起使用。</p></blockquote><h3 id="constant"><a href="#constant" class="headerlink" title="constant"></a>constant</h3><p>将目标对象的字段设置为该常量。不从源对象中映射值。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapping(target = &quot;source&quot;, constant = &quot;API&quot;)</span>  </span><br><span class="line">TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br></pre></td></tr></table></figure><p>编译后：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">targetObject.setSource( <span class="string">&quot;API&quot;</span> );</span><br></pre></td></tr></table></figure><blockquote><p>constant不能与defaultExpression，expression，defaultValue，constant, source一起使用。</p></blockquote><h3 id="expression"><a href="#expression" class="headerlink" title="expression"></a><code>expression</code></h3><p>通过表达式完成映射。要基于该字符串设置指定的目标属性。目前，Java 是唯一受支持的“表达式语言”，表达式必须使用以下格式以 Java 表达式的形式给出：<code>java（&lt;EXPRESSION&gt;）</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapping(target = &quot;sex&quot;, expression = &quot;java(SexEnum.descOfCode(source.getSex()))&quot;)</span>  </span><br><span class="line">TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br></pre></td></tr></table></figure><p>编译后：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">targetObject.setSex( SexEnum.descOfCode(source.getSex()) );</span><br></pre></td></tr></table></figure><blockquote><p>expression不能与source, defaultValue, defaultExpression, qualifiedBy, qualifiedByName 以及constant 一起使用</p></blockquote><h3 id="dateFormat"><a href="#dateFormat" class="headerlink" title="dateFormat"></a>dateFormat</h3><p>指定日期格式化模式，仅适用于日期类型的字段。可以实现<code>String</code>类型时间和<code>Date</code>相互转换，基于<code>SimpleDateFormat</code>实现。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TargetObject</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> String createTime;  </span><br><span class="line">  </span><br><span class="line">	<span class="keyword">private</span> Date loginDate;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SourceObject</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> Date createTime;  </span><br><span class="line">  </span><br><span class="line">	<span class="keyword">private</span> String loginDate;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapping(target = &quot;createTime&quot;, source = &quot;createTime&quot;, dateFormat = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span>  </span><br><span class="line"><span class="meta">@Mapping(target = &quot;loginDate&quot;, source = &quot;loginDate&quot;, dateFormat = &quot;yyyy-MM-dd&quot;)</span>  </span><br><span class="line">TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br></pre></td></tr></table></figure><p>编译后：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( source.getCreateTime() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">    targetObject.setCreateTime( <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>( <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span> ).format( source.getCreateTime() ) );  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">try</span> &#123;  </span><br><span class="line">    <span class="keyword">if</span> ( source.getLoginDate() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">        targetObject.setLoginDate( <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>( <span class="string">&quot;yyyy-MM-dd&quot;</span> ).parse( source.getLoginDate() ) );  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">catch</span> ( ParseException e ) &#123;  </span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>( e );  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="numberFormat"><a href="#numberFormat" class="headerlink" title="numberFormat"></a>numberFormat</h3><p>指定数值格式化格式，仅适用<code>Number</code>类型的字段。可以实现<code>String</code>类型数值与<code>Number</code>相互转换，基于<code>DecimalFormat</code>实现。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TargetObject</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">double</span> amountDouble;  </span><br><span class="line">	  </span><br><span class="line">	<span class="keyword">private</span> String amountStr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SourceObject</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> String amountStr;  </span><br><span class="line">  </span><br><span class="line">	<span class="keyword">private</span> <span class="type">double</span> amountDouble;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapping(target = &quot;amountDouble&quot;, source = &quot;amountStr&quot;, numberFormat = &quot;#,###.00&quot;)</span>  </span><br><span class="line"><span class="meta">@Mapping(target = &quot;amountStr&quot;, source = &quot;amountDouble&quot;, numberFormat = &quot;#,###.00&quot;)</span>  </span><br><span class="line">TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br></pre></td></tr></table></figure><p>编译后：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;  </span><br><span class="line">    <span class="keyword">if</span> ( source.getAmountStr() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">        targetObject.setAmountDouble( <span class="keyword">new</span> <span class="title class_">DecimalFormat</span>( <span class="string">&quot;#,###.00&quot;</span> ).parse( source.getAmountStr() ).doubleValue() );  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">catch</span> ( ParseException e ) &#123;  </span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>( e );  </span><br><span class="line">&#125;  </span><br><span class="line">targetObject.setAmountStr( <span class="keyword">new</span> <span class="title class_">DecimalFormat</span>( <span class="string">&quot;#,###.00&quot;</span> ).format( source.getAmountDouble() ) );</span><br></pre></td></tr></table></figure><p>还有其他的属性，这里就不过多叙述了，有兴趣或者需要的可以阅读源码。</p><h2 id="Mappings"><a href="#Mappings" class="headerlink" title="@Mappings"></a><code>@Mappings</code></h2><p>包含多个<code>@Mapping</code>注解，将多个字段映射规则组合在一起，使代码更清晰。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mappings(&#123;  </span></span><br><span class="line"><span class="meta">        @Mapping(target = &quot;source&quot;, constant = &quot;API&quot;),  </span></span><br><span class="line"><span class="meta">        @Mapping(target = &quot;sex&quot;, expression = &quot;java(SexEnum.descOfCode(source.getSex()))&quot;),  </span></span><br><span class="line"><span class="meta">        @Mapping(target = &quot;createTime&quot;, source = &quot;createTime&quot;, dateFormat = &quot;yyyy-MM-dd HH:mm:ss&quot;),  </span></span><br><span class="line"><span class="meta">        @Mapping(target = &quot;loginDate&quot;, source = &quot;loginDate&quot;, dateFormat = &quot;yyyy-MM-dd&quot;),  </span></span><br><span class="line"><span class="meta">        @Mapping(target = &quot;amountDouble&quot;, source = &quot;amountStr&quot;, numberFormat = &quot;#,###.00&quot;),  </span></span><br><span class="line"><span class="meta">        @Mapping(target = &quot;amountStr&quot;, source = &quot;amountDouble&quot;, numberFormat = &quot;#,###.00&quot;)  </span></span><br><span class="line"><span class="meta">&#125;)</span>  </span><br><span class="line">TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br></pre></td></tr></table></figure><h2 id="Named"><a href="#Named" class="headerlink" title="@Named"></a><code>@Named</code></h2><p>用于标记自定义转换器或者映射器中的某个方法的名称。一般配合<code>qualifiedByName</code> 使用：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 标记映射方法名称</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Named(&quot;sourceToTarget&quot;)</span>  </span><br><span class="line">TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;  </span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 标记转换器方法名称</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Named(&quot;convertSexDesc&quot;)</span>  </span><br><span class="line"><span class="keyword">default</span> String <span class="title function_">convertSexDesc</span><span class="params">(Integer sex)</span>&#123;  </span><br><span class="line">    <span class="keyword">return</span> SexEnum.descOfCode(sex);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们在定义自己的转换器方法时，最好把方法都加上@Named的注解标记你的方法名称，否则如果后续代码中再写一个同类型的不同方法名的转换方法时编译报错：不明确的映射方法。</p><img src="/img/loading.gif" data-lazy-src="/posts/e4bae491/20240114194040.png" title="image.png"><h2 id="IterableMapping"><a href="#IterableMapping" class="headerlink" title="@IterableMapping"></a><code>@IterableMapping</code></h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">用于集合映射，定义集合元素的映射规则。其中一些属性例如:<span class="string">`qualifiedByName`</span>，<span class="string">`qualifiedBy`</span>以及<span class="string">`dateFormat`</span>，<span class="string">`numberFormat`</span>参考<span class="string">`@Mapping`</span>中的用法。</span><br><span class="line">@Named(<span class="string">&quot;sourceToTarget&quot;</span>)  </span><br><span class="line">TargetObject sourceToTarget(SourceObject source);  </span><br><span class="line">  </span><br><span class="line">@IterableMapping(qualifiedByName = <span class="string">&quot;sourceToTarget&quot;</span>)  </span><br><span class="line">List&lt;TargetObject&gt; sourceToTargetList(List&lt;SourceObject&gt; sourceObjectList);</span><br></pre></td></tr></table></figure><p>编译后的实现类代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span>  </span><br><span class="line"><span class="keyword">public</span> List&lt;TargetObject&gt; <span class="title function_">sourceToTargetList</span><span class="params">(List&lt;SourceObject&gt; sourceObjectList)</span> &#123;  </span><br><span class="line">    <span class="keyword">if</span> ( sourceObjectList == <span class="literal">null</span> ) &#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    List&lt;TargetObject&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;TargetObject&gt;( sourceObjectList.size() );  </span><br><span class="line">    <span class="keyword">for</span> ( SourceObject sourceObject : sourceObjectList ) &#123;  </span><br><span class="line">        list.add( sourceToTarget( sourceObject ) );  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> list;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可看出它内部循环调用<code>sourceToTarget</code>的方法完成list的转换。</p><blockquote><p>需要特别注意，在写集合类型的转换时一定要配合<code>IterableMapping</code>的<code>qualifiedByName</code>和<code>Named</code>使用，如果不使用<code>@IterableMapping</code>中显示声明循环使用的方法时，它的内部会重新生成一个映射方法去使用。这样会在开发过程中出现一些莫名其妙的忽然就不好使的错误。。。。。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Named(&quot;sourceToTarget&quot;)</span>  </span><br><span class="line">    TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;  </span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Named(&quot;sourceToTarget2&quot;)</span>  </span><br><span class="line">    TargetObject <span class="title function_">sourceToTarget2</span><span class="params">(SourceObject source)</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//    @IterableMapping(qualifiedByName = &quot;sourceToTarget&quot;)  </span></span><br><span class="line">    List&lt;TargetObject&gt; <span class="title function_">sourceToTargetList</span><span class="params">(List&lt;SourceObject&gt; sourceObjectList)</span>;</span><br></pre></td></tr></table></figure><p>编译后，实现类中代码可以看出并没有使用以上两个方法，而是重新生成的：</p><img src="/img/loading.gif" data-lazy-src="/posts/e4bae491/20240114194643.png" title="image.png"> <img src="/img/loading.gif" data-lazy-src="/posts/e4bae491/20240114194658.png" title="image.png"><h2 id="MappingTarget"><a href="#MappingTarget" class="headerlink" title="@MappingTarget"></a><code>@MappingTarget</code></h2><p>标记在映射方法的目标对象参数上，允许在映射方法中修改目标对象的属性。当目标对象已经创建了，此时可以将目标对象也当做参数传递到映射器方法中。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapping(target = &quot;source&quot;, constant = &quot;API&quot;)</span>  </span><br><span class="line"><span class="meta">@Mapping(target = &quot;sex&quot;, expression = &quot;java(SexEnum.descOfCode(source.getSex()))&quot;)</span>  </span><br><span class="line"><span class="meta">@Named(&quot;sourceToTarget3&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">sourceToTarget3</span><span class="params">(<span class="meta">@MappingTarget</span> TargetObject targetObject, SourceObject source)</span>;</span><br></pre></td></tr></table></figure><p>编译后实现类代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sourceToTarget3</span><span class="params">(TargetObject targetObject, SourceObject source)</span> &#123;  </span><br><span class="line">    <span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">        <span class="keyword">return</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    targetObject.setUserName( source.getUserName() );  </span><br><span class="line">    targetObject.setUserId( source.getUserId() );  </span><br><span class="line">  </span><br><span class="line">    targetObject.setSource( <span class="string">&quot;API&quot;</span> );  </span><br><span class="line">    targetObject.setSex( SexEnum.descOfCode(source.getSex()) );  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="InheritConfiguration"><a href="#InheritConfiguration" class="headerlink" title="@InheritConfiguration"></a><code>@InheritConfiguration</code></h2><p>它用于在映射接口中引用另一个映射方法的配置。主要用于减少代码重复，提高映射方法的可维护性。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mappings(&#123;  </span></span><br><span class="line"><span class="meta">           @Mapping(target = &quot;source&quot;, constant = &quot;API&quot;),  </span></span><br><span class="line"><span class="meta">           @Mapping(target = &quot;sex&quot;, expression = &quot;java(SexEnum.descOfCode(source.getSex()))&quot;)</span></span><br><span class="line"><span class="meta">   &#125;)</span>  </span><br><span class="line">   <span class="meta">@Named(&quot;sourceToTarget&quot;)</span>  </span><br><span class="line">   TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@InheritConfiguration(name = &quot;sourceToTarget&quot;)</span>  </span><br><span class="line"><span class="meta">@Named(&quot;sourceToTarget2&quot;)</span>  </span><br><span class="line">TargetObject <span class="title function_">sourceToTarget2</span><span class="params">(SourceObject source)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@InheritConfiguration(name = &quot;sourceToTarget&quot;)</span>  </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">sourceToTarget4</span><span class="params">(<span class="meta">@MappingTarget</span> TargetObject targetObject, SourceObject source)</span>;</span><br></pre></td></tr></table></figure><p><code>sourceToTarget2</code>和<code>sourceToTarget4</code>就可以直接继承使用<code>sourceToTarget</code>的规则了。避免了再次定义一份相同的规则。</p><h2 id="InheritInverseConfiguration"><a href="#InheritInverseConfiguration" class="headerlink" title="@InheritInverseConfiguration"></a><code>@InheritInverseConfiguration</code></h2><blockquote><p>双向映射</p></blockquote><p>在双向映射的情况下，例如从实体到 DTO 以及从 DTO 到实体，正向方法和反向方法的映射规则通常是相似的，并且可以通过切换source和target来简单地反转。</p><p>使用注解<code>@InheritInverseConfiguration</code>可以标记当前方法应继承反向配置。</p><p>案例演示：carDtoToCar()方法是carToDto() 的反向映射方法。carToDto()中任何属性映射会自动反转并复制到带有<code>@InheritInverseConfiguration</code>注解的方法中。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CarMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Mapping(target = &quot;seatCount&quot;, source = &quot;numberOfSeats&quot;)</span></span><br><span class="line">  CarDto <span class="title function_">carToDto</span><span class="params">(Car car)</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@InheritInverseConfiguration</span></span><br><span class="line">  <span class="meta">@Mapping(target = &quot;numberOfSeats&quot;, ignore = true)</span></span><br><span class="line">  Car <span class="title function_">carDtoToCar</span><span class="params">(CarDto carDto)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>来自反转方法的特定映射可以被忽略（ignore）或覆盖，例如：<code>@Mapping(target = &quot;numberOfSeats&quot;, ignore=true)</code>。</p><p>需要在当前映射器（超类&#x2F;接口）中定义于反向继承的方法。</p><p>如果有多个方法符合条件，则需要使用name属性指定继承配置的方法：<code>@InheritInverseConfiguration(name = &quot;carToDto&quot;)</code>。</p><p>发生冲突时@InheritConfiguration优先于@InheritInverseConfiguration。</p><h2 id="BeanMapping"><a href="#BeanMapping" class="headerlink" title="@BeanMapping"></a><code>@BeanMapping</code></h2><p>用于配置映射方法级别的注解，它允许在单个映射方法上指定一些特定的配置。例如忽略某些属性、配置映射条件等(开始我们在<code>@Mapper</code>中定义)。它提供了一种在方法级别自定义映射行为的方式。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@BeanMapping(nullValueCheckStrategy = NullValueCheckStrategy.ALWAYS)</span>  </span><br><span class="line"><span class="meta">@Named(&quot;sourceToTarget2&quot;)</span>  </span><br><span class="line">TargetObject <span class="title function_">sourceToTarget2</span><span class="params">(SourceObject source)</span>;</span><br></pre></td></tr></table></figure><p>编译后实现的代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span>  </span><br><span class="line"><span class="keyword">public</span> TargetObject <span class="title function_">sourceToTarget2</span><span class="params">(SourceObject source)</span> &#123;  </span><br><span class="line">    <span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TargetObject</span>();  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span> ( source.getUserName() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">        targetObject.setUserName( source.getUserName() );  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">if</span> ( source.getUserId() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">        targetObject.setUserId( source.getUserId() );  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">if</span> ( source.getSex() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">        targetObject.setSex( String.valueOf( source.getSex() ) );  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> targetObject;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>校验了源对象值的null</p><h2 id="ValueMapping"><a href="#ValueMapping" class="headerlink" title="@ValueMapping"></a><code>@ValueMapping</code></h2><p>用于自定义枚举类型或其他可映射类型的值映射。该注解允许在枚举类型映射时，定义自定义的值映射规则，使得在映射中可以转换不同的枚举值。他只有两个属性值：</p><ul><li><code>source</code>：只能取值：枚举值名称，<code>MappingConstants.NULL</code>，<code>MappingConstants.ANY_REMAINING</code>，<code>MappingConstants.ANY_UNMAPPED</code></li><li><code>target</code>: 只能取值：枚举值名称<code>MappingConstants.NULL</code>，<code>MappingConstants.ANY_UNMAPPED</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">OrderType</span> &#123; RETAIL, B2B, C2C, EXTRA, STANDARD, NORMAL &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">ExternalOrderType</span> &#123; RETAIL, B2B, SPECIAL, DEFAULT &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@ValueMappings(&#123;  </span></span><br><span class="line"><span class="meta">        @ValueMapping(target = &quot;SPECIAL&quot;, source = &quot;EXTRA&quot;),  </span></span><br><span class="line"><span class="meta">        @ValueMapping(target = &quot;DEFAULT&quot;, source = &quot;STANDARD&quot;),  </span></span><br><span class="line"><span class="meta">        @ValueMapping(target = &quot;DEFAULT&quot;, source = &quot;NORMAL&quot;),  </span></span><br><span class="line"><span class="meta">        @ValueMapping(target = MappingConstants.THROW_EXCEPTION, source = &quot;C2C&quot; )  </span></span><br><span class="line"><span class="meta">&#125;)</span>  </span><br><span class="line">ExternalOrderTypeEnum <span class="title function_">mapOrderType</span><span class="params">(OrderTypeEnum orderType)</span>;	</span><br></pre></td></tr></table></figure><p>编译后实现类代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span>  </span><br><span class="line"><span class="keyword">public</span> ExternalOrderTypeEnum <span class="title function_">mapOrderType</span><span class="params">(OrderTypeEnum orderType)</span> &#123;  </span><br><span class="line">    <span class="keyword">if</span> ( orderType == <span class="literal">null</span> ) &#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    ExternalOrderTypeEnum externalOrderTypeEnum;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">switch</span> ( orderType ) &#123;  </span><br><span class="line">        <span class="keyword">case</span> EXTRA: externalOrderTypeEnum = ExternalOrderTypeEnum.SPECIAL;  </span><br><span class="line">        <span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">case</span> STANDARD: externalOrderTypeEnum = ExternalOrderTypeEnum.DEFAULT;  </span><br><span class="line">        <span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">case</span> NORMAL: externalOrderTypeEnum = ExternalOrderTypeEnum.DEFAULT;  </span><br><span class="line">        <span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">case</span> C2C: <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>( <span class="string">&quot;Unexpected enum constant: &quot;</span> + orderType );  </span><br><span class="line">        <span class="keyword">case</span> RETAIL: externalOrderTypeEnum = ExternalOrderTypeEnum.RETAIL;  </span><br><span class="line">        <span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">case</span> B2B: externalOrderTypeEnum = ExternalOrderTypeEnum.B2B;  </span><br><span class="line">        <span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">default</span>: <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>( <span class="string">&quot;Unexpected enum constant: &quot;</span> + orderType );  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> externalOrderTypeEnum;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Context"><a href="#Context" class="headerlink" title="@Context"></a><code>@Context</code></h2><p><code>@Context</code>注解在MapStruct框架中用于标记映射方法的参数，使得这些参数作为映射上下文来处理。被标注为<code>@Context</code>的参数会在适用的情况下传递给其他映射方法、<code>@ObjectFactory</code>方法或者<code>@BeforeMapping</code>和<code>@AfterMapping</code>方法，从而可以在自定义代码中使用它们。</p><p>具体作用如下：</p><ul><li><strong>传递上下文信息</strong>： 当MapStruct执行映射操作时，它会将带有<code>@Context</code>注解的参数值向下传递到关联的方法中。这意味着你可以在不同的映射阶段（包括属性映射、对象工厂方法调用以及映射前后的处理方法）共享和利用这些上下文数据。</li><li><strong>调用相关方法</strong>： MapStruct还会检查带有<code>@Context</code>注解的参数类型上是否声明了<code>@BeforeMapping</code>或<code>@AfterMapping</code>方法，并在适用时对提供的上下文参数值调用这些方法。</li><li><strong>空值处理</strong>： 注意，MapStruct不会在调用与<code>@Context</code>注解参数相关的映射前后方法或对象工厂方法之前进行空值检查。调用者需要确保在这种情况下不传递null值。</li><li><strong>生成代码的要求</strong>： 为了使生成的代码能够正确调用带有<code>@Context</code>参数的方法，正在生成的映射方法声明必须至少包含那些相同类型（或可赋值类型）的<code>@Context</code>参数。MapStruct不会为缺失的<code>@Context</code>参数创建新实例，也不会以null代替它们传递。</li></ul><p>因此，<code>@Context</code>注解提供了一种机制，允许开发者在映射过程中携带并传播额外的状态或配置信息，增强了映射逻辑的灵活性和定制能力。</p><p>一个简单的用法示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">	<span class="meta">@Named(&quot;sourceToTarget5&quot;)</span>  </span><br><span class="line">	<span class="meta">@Mapping(target = &quot;createTime&quot;, constant = &quot;createTime&quot;, qualifiedByName = &quot;formatDate&quot;)</span>  </span><br><span class="line">	TargetObject <span class="title function_">sourceToTarget5</span><span class="params">(SourceObject source, <span class="meta">@Context</span> ContextObject contextObject)</span>;  </span><br><span class="line">	  </span><br><span class="line">	<span class="meta">@Named(&quot;formatDate&quot;)</span>  </span><br><span class="line">	<span class="keyword">default</span> String <span class="title function_">formatDate</span><span class="params">(LocalDateTime createTime, <span class="meta">@Context</span> ContextObject contextObject)</span>&#123;  </span><br><span class="line">	<span class="type">DateTimeFormatter</span> <span class="variable">dateTimeFormatter</span> <span class="operator">=</span> contextObject.getDateTimeFormatter();  </span><br><span class="line">	<span class="keyword">return</span> dateTimeFormatter.format(createTime);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>生成的实现类代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span>  </span><br><span class="line"><span class="keyword">public</span> TargetObject <span class="title function_">sourceToTarget5</span><span class="params">(SourceObject source, ContextObject contextObject)</span> &#123;  </span><br><span class="line">	<span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">	&#125;  </span><br><span class="line">	  </span><br><span class="line">	<span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TargetObject</span>();  </span><br><span class="line">	  </span><br><span class="line">	targetObject.setUserName( source.getUserName() );  </span><br><span class="line">	targetObject.setUserId( source.getUserId() );  </span><br><span class="line">	<span class="keyword">if</span> ( source.getSex() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">		targetObject.setSex( String.valueOf( source.getSex() ) );  </span><br><span class="line">	&#125;  </span><br><span class="line">	  </span><br><span class="line">	targetObject.setCreateTime( formatDate( LocalDateTime.parse( <span class="string">&quot;createTime&quot;</span> ), contextObject ) );  </span><br><span class="line">	  </span><br><span class="line">	<span class="keyword">return</span> targetObject;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="BeforeMapping"><a href="#BeforeMapping" class="headerlink" title="@BeforeMapping"></a><code>@BeforeMapping</code></h2><p>这个注解可以标注在一个没有返回值的方法上，该方法会在执行实际映射操作前被调用。在此方法中可以通过<code>@Context</code>注入上下文对象，并根据需要对源对象或上下文进行修改或预处理。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">	<span class="meta">@Named(&quot;sourceToTarget5&quot;)</span>  </span><br><span class="line">	<span class="meta">@Mapping(target = &quot;createTime&quot;, constant = &quot;createTime&quot;, qualifiedByName = &quot;formatDate&quot;)</span>  </span><br><span class="line">	TargetObject <span class="title function_">sourceToTarget5</span><span class="params">(SourceObject source, <span class="meta">@Context</span> ContextObject contextObject)</span>;  </span><br><span class="line">	  </span><br><span class="line">	<span class="meta">@Named(&quot;formatDate&quot;)</span>  </span><br><span class="line">	<span class="keyword">default</span> String <span class="title function_">formatDate</span><span class="params">(LocalDateTime createTime, <span class="meta">@Context</span> ContextObject contextObject)</span>&#123;  </span><br><span class="line">		<span class="type">DateTimeFormatter</span> <span class="variable">dateTimeFormatter</span> <span class="operator">=</span> contextObject.getDateTimeFormatter();  </span><br><span class="line">		<span class="keyword">return</span> dateTimeFormatter.format(createTime);  </span><br><span class="line">	&#125;  </span><br><span class="line">	  </span><br><span class="line">	<span class="meta">@BeforeMapping</span>  </span><br><span class="line">	<span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">beforeFormatDate</span><span class="params">(<span class="meta">@Context</span> ContextObject context)</span> &#123;  </span><br><span class="line">		<span class="comment">// 在映射之前初始化或更新上下文中的信息  </span></span><br><span class="line">		context.setDateTimeFormatter(DateTimeFormatter.ofPattern(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译后生成的实现类代码中，会发现在<code>sourceToTarget5</code>的方法第一行会调用<code>beforeFormatDate</code>这个方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span>  </span><br><span class="line"><span class="keyword">public</span> TargetObject <span class="title function_">sourceToTarget5</span><span class="params">(SourceObject source, ContextObject contextObject)</span> &#123;  </span><br><span class="line">	<span class="comment">// 第一行调用@BeforeMapping的方法</span></span><br><span class="line">	beforeFormatDate( contextObject );  </span><br><span class="line">	  </span><br><span class="line">	<span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">	&#125;  </span><br><span class="line">	  </span><br><span class="line">	<span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TargetObject</span>();  </span><br><span class="line">	  </span><br><span class="line">	targetObject.setUserName( source.getUserName() );  </span><br><span class="line">	targetObject.setUserId( source.getUserId() );  </span><br><span class="line">	<span class="keyword">if</span> ( source.getSex() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">		targetObject.setSex( String.valueOf( source.getSex() ) );  </span><br><span class="line">	&#125;  </span><br><span class="line">	  </span><br><span class="line">	targetObject.setCreateTime( formatDate( LocalDateTime.parse( <span class="string">&quot;createTime&quot;</span> ), contextObject ) );  </span><br><span class="line">	  </span><br><span class="line">	<span class="keyword">return</span> targetObject;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="AfterMapping"><a href="#AfterMapping" class="headerlink" title="@AfterMapping"></a><code>@AfterMapping</code></h2><p>这个注解同样可以标注在一个没有返回值的方法上，但它会在完成所有属性映射后被调用。你可以在这里执行一些额外的转换逻辑或者基于映射结果和上下文进行后期处理。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Named(&quot;sourceToTarget5&quot;)</span>  </span><br><span class="line"><span class="meta">@Mapping(target = &quot;createTime&quot;, constant = &quot;createTime&quot;, qualifiedByName = &quot;formatDate&quot;)</span>  </span><br><span class="line">TargetObject <span class="title function_">sourceToTarget5</span><span class="params">(SourceObject source, <span class="meta">@Context</span> ContextObject contextObject)</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="meta">@Named(&quot;formatDate&quot;)</span>  </span><br><span class="line"><span class="keyword">default</span> String <span class="title function_">formatDate</span><span class="params">(LocalDateTime createTime, <span class="meta">@Context</span> ContextObject contextObject)</span>&#123;  </span><br><span class="line">	<span class="type">DateTimeFormatter</span> <span class="variable">dateTimeFormatter</span> <span class="operator">=</span> contextObject.getDateTimeFormatter();  </span><br><span class="line">	<span class="keyword">return</span> dateTimeFormatter.format(createTime);  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="meta">@BeforeMapping</span>  </span><br><span class="line"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">beforeFormatDate</span><span class="params">(<span class="meta">@Context</span> ContextObject context)</span> &#123;  </span><br><span class="line"><span class="comment">// 在映射之前初始化或更新上下文中的信息  </span></span><br><span class="line">	context.setDateTimeFormatter(DateTimeFormatter.ofPattern(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="meta">@AfterMapping</span>  </span><br><span class="line"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">afterHandler</span><span class="params">(SourceObject source, <span class="meta">@MappingTarget</span> TargetObject targetObject, <span class="meta">@Context</span> ContextObject contextObject)</span>&#123;  </span><br><span class="line">	targetObject.setContext(contextObject.getContext());  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译后，可以发现在<code>sourceTarget5</code>的实现方法中的最后会调用<code>afterHandler</code>方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span>  </span><br><span class="line"><span class="keyword">public</span> TargetObject <span class="title function_">sourceToTarget5</span><span class="params">(SourceObject source, ContextObject contextObject)</span> &#123;  </span><br><span class="line">	beforeFormatDate( contextObject );  </span><br><span class="line">	  </span><br><span class="line">	<span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">	&#125;  </span><br><span class="line">	  </span><br><span class="line">	<span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TargetObject</span>();  </span><br><span class="line">	  </span><br><span class="line">	targetObject.setUserName( source.getUserName() );  </span><br><span class="line">	targetObject.setUserId( source.getUserId() );  </span><br><span class="line">	<span class="keyword">if</span> ( source.getSex() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">		targetObject.setSex( String.valueOf( source.getSex() ) );  </span><br><span class="line">	&#125;  </span><br><span class="line">	  </span><br><span class="line">	targetObject.setCreateTime( formatDate( LocalDateTime.parse( <span class="string">&quot;createTime&quot;</span> ), contextObject ) );  </span><br><span class="line">	  </span><br><span class="line">	afterHandler( source, targetObject, contextObject );  </span><br><span class="line">	  </span><br><span class="line">	<span class="keyword">return</span> targetObject;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>@BeforeMapping</code> 和 <code>@AfterMapping</code> 注解的方法默认会作用于在同一接口内使用了相同参数类型的映射方法上。如果想要在一个地方定义一个通用的前置或后置处理逻辑，并让它应用于多个映射方法，可以编写一个不带具体映射源和目标参数的方法，并在需要应用这些逻辑的所有映射方法上保持相同的<code>@Context</code>参数类型。</p><h2 id="ObjectFactory"><a href="#ObjectFactory" class="headerlink" title="@ObjectFactory"></a><code>@ObjectFactory</code></h2><p>此注解用于声明一个工厂方法，该方法在目标对象实例化阶段被调用。这里也可以通过<code>@Context</code>获取到上下文信息，以便在创建目标对象时就考虑到某些上下文依赖。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Named(&quot;sourceToTarget5&quot;)</span>  </span><br><span class="line"><span class="meta">@Mapping(target = &quot;createTime&quot;, constant = &quot;createTime&quot;, qualifiedByName = &quot;formatDate&quot;)</span>  </span><br><span class="line">TargetObject <span class="title function_">sourceToTarget5</span><span class="params">(SourceObject source, <span class="meta">@Context</span> ContextObject contextObject)</span>;  </span><br><span class="line">  </span><br><span class="line"><span class="meta">@Named(&quot;formatDate&quot;)</span>  </span><br><span class="line"><span class="keyword">default</span> String <span class="title function_">formatDate</span><span class="params">(LocalDateTime createTime, <span class="meta">@Context</span> ContextObject contextObject)</span>&#123;  </span><br><span class="line">	<span class="type">DateTimeFormatter</span> <span class="variable">dateTimeFormatter</span> <span class="operator">=</span> contextObject.getDateTimeFormatter();  </span><br><span class="line">	<span class="keyword">return</span> dateTimeFormatter.format(createTime);  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="meta">@BeforeMapping</span>  </span><br><span class="line"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">beforeFormatDate</span><span class="params">(<span class="meta">@Context</span> ContextObject context)</span> &#123;  </span><br><span class="line">	<span class="comment">// 在映射之前初始化或更新上下文中的信息  </span></span><br><span class="line">	context.setDateTimeFormatter(DateTimeFormatter.ofPattern(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="meta">@AfterMapping</span>  </span><br><span class="line"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">afterHandler</span><span class="params">(SourceObject source, <span class="meta">@MappingTarget</span> TargetObject targetObject, <span class="meta">@Context</span> ContextObject contextObject)</span>&#123;  </span><br><span class="line">	targetObject.setContext(contextObject.getContext());  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="meta">@ObjectFactory</span>  </span><br><span class="line"><span class="keyword">default</span> TargetObject <span class="title function_">createTargetObject</span><span class="params">(<span class="meta">@Context</span> ContextObject contextObject)</span>&#123;  </span><br><span class="line">	<span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TargetObject</span>();  </span><br><span class="line">	<span class="comment">// 根据上下文初始化dto的一些属性  </span></span><br><span class="line">	targetObject.setContext(contextObject.getContext());  </span><br><span class="line">	<span class="keyword">return</span> targetObject;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译后生成的实现类中，会看见<code>TargetObject</code>会通过<code>createTargetObject</code>方法创建：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span>  </span><br><span class="line"><span class="keyword">public</span> TargetObject <span class="title function_">sourceToTarget5</span><span class="params">(SourceObject source, ContextObject contextObject)</span> &#123;  </span><br><span class="line">	beforeFormatDate( contextObject );  </span><br><span class="line">	  </span><br><span class="line">	<span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">	<span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">	&#125;  </span><br><span class="line">	  </span><br><span class="line">	<span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> createTargetObject( contextObject );  </span><br><span class="line">	  </span><br><span class="line">	targetObject.setUserName( source.getUserName() );  </span><br><span class="line">	targetObject.setUserId( source.getUserId() );  </span><br><span class="line">	<span class="keyword">if</span> ( source.getSex() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">		targetObject.setSex( String.valueOf( source.getSex() ) );  </span><br><span class="line">	&#125;  </span><br><span class="line">	  </span><br><span class="line">	targetObject.setCreateTime( formatDate( LocalDateTime.parse( <span class="string">&quot;createTime&quot;</span> ), contextObject ) );  </span><br><span class="line">	  </span><br><span class="line">	afterHandler( source, targetObject, contextObject );  </span><br><span class="line">	  </span><br><span class="line">	<span class="keyword">return</span> targetObject;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>@ObjectFactory</code> 标记的方法则更具有针对性，它通常用于为特定的目标对象创建实例。如果你定义了一个<code>@ObjectFactory</code>方法且没有指定具体映射方法，则这个工厂方法会作为默认的实例化方式，在所有未明确提供实例化方法的映射目标对象时被调用。</p><h1 id="SpringBoot集成"><a href="#SpringBoot集成" class="headerlink" title="SpringBoot集成"></a>SpringBoot集成</h1><p>上面我们说到了<code>@Mapper</code>注解以及他的属性<code>componentModel</code>，将该值设置为<code>Spring</code>也就是<code>MappingConstants.ComponentModel.SPRING</code>值时，这个映射器生成的实现类就可以被<code>Spring</code>容器管理，这样就可以在使用时就可以注入到其他组件中了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper(uses = &#123;MyNameConverter.class&#125;, imports = &#123;SexEnum.class&#125;, componentModel = MappingConstants.ComponentModel.SPRING)</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyMapper</span> &#123;</span><br><span class="line">	<span class="meta">@Mappings(&#123;  </span></span><br><span class="line"><span class="meta">	@Mapping(target = &quot;source&quot;, constant = &quot;API&quot;),  </span></span><br><span class="line"><span class="meta">	@Mapping(target = &quot;sex&quot;, expression = &quot;java(SexEnum.descOfCode(source.getSex()))&quot;),  </span></span><br><span class="line"><span class="meta">	&#125;)</span>  </span><br><span class="line">	<span class="meta">@Named(&quot;sourceToTarget&quot;)</span>  </span><br><span class="line">	TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span>;</span><br><span class="line">&#125;	</span><br></pre></td></tr></table></figure><p>生成的实现类自动加上<code>@Component</code>注解，并将其注册为Spring Bean，：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyMapperImpl</span> <span class="keyword">implements</span> <span class="title class_">MyMapper</span> &#123;</span><br><span class="line">	<span class="meta">@Override</span>  </span><br><span class="line">	<span class="keyword">public</span> TargetObject <span class="title function_">sourceToTarget</span><span class="params">(SourceObject source)</span> &#123;  </span><br><span class="line">		<span class="keyword">if</span> ( source == <span class="literal">null</span> ) &#123;  </span><br><span class="line">			<span class="keyword">return</span> <span class="literal">null</span>;  </span><br><span class="line">		&#125;  </span><br><span class="line">		  </span><br><span class="line">		<span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TargetObject</span>();  </span><br><span class="line">		  </span><br><span class="line">		targetObject.setUserName( source.getUserName() );  </span><br><span class="line">		targetObject.setUserId( source.getUserId() );  </span><br><span class="line">		<span class="keyword">if</span> ( source.getCreateTime() != <span class="literal">null</span> ) &#123;  </span><br><span class="line">			targetObject.setCreateTime( DateTimeFormatter.ISO_LOCAL_DATE_TIME.format( source.getCreateTime() ) );  </span><br><span class="line">		&#125;  </span><br><span class="line">		  </span><br><span class="line">		targetObject.setSource( <span class="string">&quot;API&quot;</span> );  </span><br><span class="line">		targetObject.setSex( SexEnum.descOfCode(source.getSex()) );  </span><br><span class="line">		  </span><br><span class="line">		<span class="keyword">return</span> targetObject;  </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样就可以在其他组件中注入<code>MyMapper</code>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span>  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringbootCodeApplicationTests</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> MyMapper mapper;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span>  </span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">testMapper</span><span class="params">()</span>&#123;  </span><br><span class="line">		<span class="type">TargetObject</span> <span class="variable">targetObject</span> <span class="operator">=</span> mapper.sourceToTarget(<span class="keyword">new</span> <span class="title class_">SourceObject</span>());  </span><br><span class="line">		System.out.println(targetObject.getSex());  </span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span>  </span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMapper</span><span class="params">(MyMapper mapper)</span> &#123;  </span><br><span class="line">	<span class="built_in">this</span>.mapper = mapper;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者:</span> <span class="post-copyright-info"><a href="https://xiaowu95.wang">小五</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接:</span> <span class="post-copyright-info"><a href="https://xiaowu95.wang/posts/e4bae491/">https://xiaowu95.wang/posts/e4bae491/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明:</span> <span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://xiaowu95.wang" target="_blank">小五的个人杂货铺</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/java/">java</a><a class="post-meta__tags" href="/tags/springboot/">springboot</a><a class="post-meta__tags" href="/tags/MapStruct/">MapStruct</a></div><div class="post-share"><div class="social-share" data-image="/img/nba-logo30.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>感谢支持</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wxpay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/loading.gif" data-lazy-src="/img/wxpay.jpg" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/loading.gif" data-lazy-src="/img/alipay.jpg" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/b0ad13a0/" title="springdoc整合"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/nba-logo24.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">springdoc整合</div></div><div class="info-2"><div class="info-item-1">前言SpringDoc是一个用来自动生成API文档的库。它是基于SpringBoot项目的，遵循OpenAPI3(一个组织规定的规范)规范。它是通过检查我们运行中的程序，推断出基于Spring配置、类结构和各种注解的API语义，从而自动生成JSON、YAML和HTML格式的接口文档。 而我们不得不提的就是Swagger。Swagger是一个公司的开源项目，将自己的API设计贡献给了OpenAPI并由其标准化。在SpringDoc之前我们还可以使用Springfox,和SpringDoc一样是一个用于生成API文档的库，2020年起不再更新。 官方文档链接：https://springdoc.org/#Introduction 使用插件使用【用于生成openapi.json】：https://springdoc.org/#plugins 官方demo文档：https://github.com/springdoc/springdoc-openapi-demos 访问主页：http://localhost:8080/swagger-ui.html 注解介绍@Tag1234567//...</div></div></div></a><a class="pagination-related" href="/posts/1857b477/" title="kubectl port-forward"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/nba-logo11.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">kubectl port-forward</div></div><div class="info-2"><div class="info-item-1">kubectl port-forward 是 Kubernetes 提供的一个命令行工具，它允许你从本地机器转发一个或多个端口到 Kubernetes 集群中的 Pod。这个功能在开发和调试应用程序时非常有用，因为它可以让你直接访问集群中的服务，而不需要通过 Kubernetes 的服务发现和负载均衡机制。 使用 kubectl port-forward 的一些常见场景包括： 快速访问服务：当开发者需要迅速检查集群内部署的服务是否正常运行时，他们可以直接将该服务的端口转发到本地机器来访问。 调试应用：如果开发者需要调试集群内部的应用程序，在该应用程序没有暴露为服务或者没有外部IP时，port-forward 可以提供一个快速的解决方案。 数据库调试：对于涉及数据库的服务，port-forward 允许开发者使用本地数据库客户端工具连接到集群中的数据库 Pod，进行调试和查询操作。 基本语法为： 1kubectl port-forward TYPE/NAME [options] LOCAL_PORT:REMOTE_PORT TYPE/NAME 是指定的资源类型和名称，例如...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/fde9e087/" title="(Address already in use xxx) or (No buffer space available (maximum connections reached) connect)"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/nba-logo2.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2023-06-16</div><div class="info-item-2">(Address already in use xxx) or (No buffer space available (maximum connections reached) connect)</div></div><div class="info-2"><div class="info-item-1">No buffer space available (maximum connections reached?): connect Address already in use xxx 123一般可以先查看代码中是否有一些连接未关闭1. 比如es的restclient,或者其他的httpclient2. 再或者可以检查下是否有长时间占用未被释放的jdbc connection</div></div></div></a><a class="pagination-related" href="/posts/14294f14/" title="BigDecimal工具类小记"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/nba-logo29.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2023-06-16</div><div class="info-item-2">BigDecimal工具类小记</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a><a class="pagination-related" href="/posts/227b7dd1/" title="CompletableFuture"><img class="cover" src="/img/loading.gif" data-lazy-src="/img/nba-logo2.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2024-10-23</div><div class="info-item-2">CompletableFuture</div></div><div class="info-2"><div class="info-item-1">CompletableFuture 在Java8中，CompletableFuture提供了非常强大的Future的扩展功能，可以帮助我们简化异步编程的复杂性，并且提供了函数式编程的能力，可以通过回调的方式处理计算结果，也提供了转换和组合 CompletableFuture 的方法。 它可能代表一个明确完成的Future，也有可能代表一个完成阶段（ CompletionStage ），它支持在计算完成以后触发一些函数或执行某些动作。 它实现了Future和CompletionStage接口 创建CompletableFuture supplyAsync 有 runAsync...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/loading.gif" data-lazy-src="/img/avatar.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info-name">小五</div><div class="author-info-description">Tomorrow will be better,Everything will be fine</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">550</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">163</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">58</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/wang-xiaowu"><i class="fab fa-github"></i><span>GitHub</span></a><div class="card-info-social-icons"><a class="social-icon" href="/random" target="_blank" title="随便逛逛"><i class="fa-solid fa-shuffle"></i></a><a class="social-icon" href="mailto:wangxiaowu950330@foxmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://space.bilibili.com/30655189?spm_id_from=333.1007.0.0" rel="external nofollow noreferrer" target="_blank" title="BiliBili"><i class="fa-brands fa-bilibili"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fa-solid fa-rss"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-number">1.</span> <span class="toc-text">配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Maven"><span class="toc-number">1.1.</span> <span class="toc-text">Maven</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gradle"><span class="toc-number">1.2.</span> <span class="toc-text">Gradle</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%98%A0%E5%B0%84%E6%8E%A5%E5%8F%A3%EF%BC%88%E6%99%AE%E9%80%9A%E4%BD%BF%E7%94%A8%EF%BC%89"><span class="toc-number">2.</span> <span class="toc-text">创建映射接口（普通使用）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E6%8E%A5%E5%8F%A3%E4%BD%BF%E7%94%A8"><span class="toc-number">2.1.</span> <span class="toc-text">映射接口使用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MapStruct%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3"><span class="toc-number">3.</span> <span class="toc-text">MapStruct常用注解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Mapper"><span class="toc-number">3.1.</span> <span class="toc-text">@Mapper</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#componentModel"><span class="toc-number">3.1.1.</span> <span class="toc-text">componentModel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#uses"><span class="toc-number">3.1.2.</span> <span class="toc-text">uses</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#imports"><span class="toc-number">3.1.3.</span> <span class="toc-text">imports</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#config"><span class="toc-number">3.1.4.</span> <span class="toc-text">config</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nullValueCheckStrategy"><span class="toc-number">3.1.5.</span> <span class="toc-text">nullValueCheckStrategy</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MapperConfig"><span class="toc-number">3.2.</span> <span class="toc-text">@MapperConfig</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mapping"><span class="toc-number">3.3.</span> <span class="toc-text">@Mapping</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#source-%E5%92%8C-target"><span class="toc-number">3.3.1.</span> <span class="toc-text">source 和 target:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#qualifiedByName-%E5%92%8C-qualifiedBy"><span class="toc-number">3.3.2.</span> <span class="toc-text">qualifiedByName 和 qualifiedBy:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ignore"><span class="toc-number">3.3.3.</span> <span class="toc-text">ignore</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#defaultExpression"><span class="toc-number">3.3.4.</span> <span class="toc-text">defaultExpression</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#defaultValue"><span class="toc-number">3.3.5.</span> <span class="toc-text">defaultValue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#constant"><span class="toc-number">3.3.6.</span> <span class="toc-text">constant</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#expression"><span class="toc-number">3.3.7.</span> <span class="toc-text">expression</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dateFormat"><span class="toc-number">3.3.8.</span> <span class="toc-text">dateFormat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#numberFormat"><span class="toc-number">3.3.9.</span> <span class="toc-text">numberFormat</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mappings"><span class="toc-number">3.4.</span> <span class="toc-text">@Mappings</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Named"><span class="toc-number">3.5.</span> <span class="toc-text">@Named</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IterableMapping"><span class="toc-number">3.6.</span> <span class="toc-text">@IterableMapping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MappingTarget"><span class="toc-number">3.7.</span> <span class="toc-text">@MappingTarget</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#InheritConfiguration"><span class="toc-number">3.8.</span> <span class="toc-text">@InheritConfiguration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#InheritInverseConfiguration"><span class="toc-number">3.9.</span> <span class="toc-text">@InheritInverseConfiguration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanMapping"><span class="toc-number">3.10.</span> <span class="toc-text">@BeanMapping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ValueMapping"><span class="toc-number">3.11.</span> <span class="toc-text">@ValueMapping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Context"><span class="toc-number">3.12.</span> <span class="toc-text">@Context</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BeforeMapping"><span class="toc-number">3.13.</span> <span class="toc-text">@BeforeMapping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AfterMapping"><span class="toc-number">3.14.</span> <span class="toc-text">@AfterMapping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ObjectFactory"><span class="toc-number">3.15.</span> <span class="toc-text">@ObjectFactory</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot%E9%9B%86%E6%88%90"><span class="toc-number">4.</span> <span class="toc-text">SpringBoot集成</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/c75c82a0/" title="使用 TypeScript 创建 Koa 服务器"><img src="/img/loading.gif" data-lazy-src="/img/nba-logo16.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="使用 TypeScript 创建 Koa 服务器"></a><div class="content"><a class="title" href="/posts/c75c82a0/" title="使用 TypeScript 创建 Koa 服务器">使用 TypeScript 创建 Koa 服务器</a><time datetime="2025-10-11T06:00:11.000Z" title="发表于 2025-10-11 14:00:11">2025-10-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/c9d8bfa7/" title="Nodejs应用提取heap并加以分析的一些常用方法"><img src="/img/loading.gif" data-lazy-src="/img/nba-logo24.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Nodejs应用提取heap并加以分析的一些常用方法"></a><div class="content"><a class="title" href="/posts/c9d8bfa7/" title="Nodejs应用提取heap并加以分析的一些常用方法">Nodejs应用提取heap并加以分析的一些常用方法</a><time datetime="2025-09-28T07:54:43.000Z" title="发表于 2025-09-28 15:54:43">2025-09-28</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url(/img/nba-logo30.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By 小五</div><div class="framework-info"><span>框架</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题</span> <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a href="https://www.foreverblog.cn/" rel="external nofollow noreferrer" target="_blank"><img src="/img/loading.gif" data-lazy-src="https://img.foreverblog.cn/logo_en_default.png" alt="十年之约" style="width:auto;height:16px"></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/npm/hexo-theme-butterfly@5.2.2/source/js/utils.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-butterfly@5.2.2/source/js/main.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-butterfly@5.2.2/source/js/tw_cn.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.36/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.1.3/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"><script>(()=>{const e=()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");if(0===e.length)return;const t=()=>(e=>{window.loadMermaid=!0;const t="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";e.forEach(((e,n)=>{const d=e.firstElementChild,a=`mermaid-${n}`,r=`%%{init:{ 'theme':'${t}'}}%%\n`+d.textContent,i=mermaid.render(a,r),m=e=>{d.insertAdjacentHTML("afterend",e)};"string"==typeof i?m(i):i.then((({svg:e})=>m(e)))}))})(e);btf.addGlobalFn("themeChange",t,"mermaid"),window.loadMermaid?t():btf.getScript("https://cdn.jsdelivr.net/npm/mermaid@11.4.0/dist/mermaid.min.js").then(t)};btf.addGlobalFn("encrypt",e,"mermaid"),window.pjax?e():document.addEventListener("DOMContentLoaded",e)})()</script><script>(()=>{const t=document.querySelectorAll("#article-container .chartjs-container");if(0===t.length)return;const e=(t,a)=>{"object"==typeof t&&null!==t&&Object.keys(t).forEach((r=>{const n=t[r];"object"==typeof n&&null!==n&&(n[a]?t[r]=n[a]:e(n,a))}))},a=()=>{window.loadChartJS=!0,Array.from(t).forEach(((t,a)=>{const r=t.firstElementChild,n=t.getAttribute("data-chartjs-id")||"chartjs-"+a,d=t.getAttribute("data-width"),o=document.getElementById(n);o&&o.parentNode.remove();const c=r.textContent,l=document.createElement("canvas");l.id=n;const s=document.createElement("div");s.className="chartjs-wrap",d&&(s.style.width=d),s.appendChild(l),r.insertAdjacentElement("afterend",s);const h=document.getElementById(n).getContext("2d"),i=JSON.parse(c),m="dark"===document.documentElement.getAttribute("data-theme")?"dark-mode":"light-mode";(t=>{"dark-mode"===t?(Chart.defaults.color="rgba(255, 255, 255, 0.8)",Chart.defaults.borderColor="rgba(255, 255, 255, 0.2)",Chart.defaults.scale.ticks.backdropColor="transparent"):(Chart.defaults.color="rgba(0, 0, 0, 0.8)",Chart.defaults.borderColor="rgba(0, 0, 0, 0.1)",Chart.defaults.scale.ticks.backdropColor="transparent")})(m),e(i,m),new Chart(h,i)}))},r=()=>{window.loadChartJS?a():btf.getScript("https://cdn.jsdelivr.net/npm/chart.js@4.4.6/dist/chart.umd.min.js").then(a)};btf.addGlobalFn("themeChange",a,"chartjs"),btf.addGlobalFn("encrypt",a,"chartjs"),window.pjax?r():document.addEventListener("DOMContentLoaded",r)})()</script></div><div class="aplayer no-destroy" data-id="9061017364" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listfolded="false" data-order="random" data-lrctype="1" data-preload="none" data-autoplay="false" muted></div><div class="app-refresh" id="app-refresh"><div class="app-refresh-wrap"><label>网站已更新最新版本</label> <a href="javascript:void(0)" rel="external nofollow noreferrer" onclick="location.reload()">点击刷新</a></div></div><script>function showNotification(){if(GLOBAL_CONFIG.Snackbar){var t="light"===document.documentElement.getAttribute("data-theme")?GLOBAL_CONFIG.Snackbar.bgLight:GLOBAL_CONFIG.Snackbar.bgDark,e=GLOBAL_CONFIG.Snackbar.position;Snackbar.show({text:"已更新最新版本",backgroundColor:t,duration:5e5,pos:e,actionText:"点击刷新",actionTextColor:"#fff",onActionClick:function(t){location.reload()}})}else{var o=`top: 0; background: ${"light"===document.documentElement.getAttribute("data-theme")?"#49b1f5":"#1f1f1f"};`;document.getElementById("app-refresh").style.cssText=o}}"serviceWorker"in navigator&&(navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("controllerchange",(function(){showNotification()})),window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js")})))</script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script defer src="/js/diytitle.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,POWERMODE.mobile=!0,document.body.addEventListener("input",POWERMODE)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/metingjs/dist/Meting.min.js"></script><script>btf.addGlobalFn("pjaxSend",(()=>{if(window.aplayers)for(let a=0;a<window.aplayers.length;a++)window.aplayers[a].options.fixed||window.aplayers[a].destroy()}),"destroyAplayer"),btf.addGlobalFn("pjaxComplete",loadMeting,"runMetingJS")</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>(()=>{window.pjax=new Pjax({elements:'a:not([target="_blank"]):not([href="/talking/"]):not([href="/artitalk/"])',selectors:['link[rel="canonical"]','meta[property="og:image"]','meta[property="og:title"]','meta[property="og:url"]',"head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"],cacheBust:!1,analytics:!0,scrollRestoration:!1});const e=e=>{e&&Object.values(e).forEach((e=>e()))};document.addEventListener("pjax:send",(()=>{btf.removeGlobalFnEvent("pjaxSendOnce"),btf.removeGlobalFnEvent("themeChange");const t=document.body.classList;t.contains("read-mode")&&t.remove("read-mode"),e(window.globalFn.pjaxSend)})),document.addEventListener("pjax:complete",(()=>{btf.removeGlobalFnEvent("pjaxCompleteOnce"),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),a=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(a)),e.parentNode.replaceChild(t,e)})),e(window.globalFn.pjaxComplete)})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404")}))})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch@5.12.0/dist/lite/builds/browser.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.75.3/dist/instantsearch.production.min.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-theme-butterfly@5.2.2/source/js/search/algolia.min.js"></script></div></div><script data-pjax>if(document.getElementById("recent-posts")&&"/"==location.pathname){var parent=document.getElementById("recent-posts"),child='<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo25.jpg" alt="/img/nba-logo25.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2024-02-02</span><a class="blog-slider__title" href="posts/1bcb0ad4/">单环境,多分支并行开发方案(流量染色/istio)</a><div class="blog-slider__text">单环境,多分支并行开发方案(流量染色/istio)</div><a class="blog-slider__button" href="posts/1bcb0ad4/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo15.jpg" alt="/img/nba-logo15.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2023-04-06</span><a class="blog-slider__title" href="posts/2a9d73ff/">教你如何零成本从0到1，开发上线一个对接了openAI的机器人</a><div class="blog-slider__text">教你如何零成本从0到1，开发上线一个对接了openAI的机器人</div><a class="blog-slider__button" href="posts/2a9d73ff/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo3.jpg" alt="/img/nba-logo3.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2023-06-14</span><a class="blog-slider__title" href="posts/aa43cc95/">记录k8s环境下结合alinode的使用</a><div class="blog-slider__text">记录k8s环境下结合alinode的使用</div><a class="blog-slider__button" href="posts/aa43cc95/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo29.jpg" alt="/img/nba-logo29.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2022-12-13</span><a class="blog-slider__title" href="posts/15957791/">k8s环境下,nginx做websocket负载的方案梳理</a><div class="blog-slider__text">k8s环境下,nginx做websocket负载的方案梳理</div><a class="blog-slider__button" href="posts/15957791/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo12.jpg" alt="/img/nba-logo12.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2023-09-26</span><a class="blog-slider__title" href="posts/4ecfb081/">记录一次k8s网络DNS问题排查过程</a><div class="blog-slider__text">记录一次k8s网络DNS问题排查过程</div><a class="blog-slider__button" href="posts/4ecfb081/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo12.jpg" alt="/img/nba-logo12.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2023-09-26</span><a class="blog-slider__title" href="posts/37032a87/">k3s高可用安装</a><div class="blog-slider__text">k3s高可用安装</div><a class="blog-slider__button" href="posts/37032a87/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo17.jpg" alt="/img/nba-logo17.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2022-11-27</span><a class="blog-slider__title" href="posts/20b19ed4/">分词搜索需求整理</a><div class="blog-slider__text">分词搜索需求整理</div><a class="blog-slider__button" href="posts/20b19ed4/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo9.jpg" alt="/img/nba-logo9.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2022-12-02</span><a class="blog-slider__title" href="posts/6de14387/">整理wsl2配合开发的一些配置</a><div class="blog-slider__text">整理wsl2配合开发的一些配置</div><a class="blog-slider__button" href="posts/6de14387/">详情</a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms"><div class="blog-slider__img"><img src= "/img/loading.gif" data-lazy-src="/img/nba-logo30.jpg" alt="/img/nba-logo30.jpg"/></div><div class="blog-slider__content"><span class="blog-slider__code">2021-12-11</span><a class="blog-slider__title" href="posts/fb9adcb6/">记录windows11+wsl2环境搭配</a><div class="blog-slider__text">windows11+wsl2开发环境配置</div><a class="blog-slider__button" href="posts/fb9adcb6/">详情</a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';console.log("已挂载swiper"),parent.insertAdjacentHTML("afterbegin",child)}</script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper/swiper/swiper.min.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-swiper@0.18/swiper/swiperindex.js"></script><style></style><script data-pjax>function history_calendar_injector_config(){var i=document.getElementsByClassName("sticky_layout")[0];console.log("已挂载history_calendar"),i.insertAdjacentHTML("afterbegin",'<div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span>那年今日</span></div><div id="history-baidu" style="height: 100px;overflow: hidden"><div class="history_swiper-container" id="history-container" style="width: 100%;height: 100%"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div>')}document.getElementsByClassName("sticky_layout")[0]&&"/"===location.pathname&&history_calendar_injector_config()</script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({tagMode:!1,debug:!1,model:{jsonPath:"/live2dw/assets/wanko.model.json"},display:{position:"right",width:150,height:300,hOffset:20,vOffset:-20},mobile:{show:!0},log:!1,pluginJsPath:"lib/",pluginModelPath:"assets/",pluginRootPath:"live2dw/"})</script></body></html>